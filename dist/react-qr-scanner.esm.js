import React, { useRef, useState, useMemo, useEffect, useCallback } from 'react';
import PropTypes from 'prop-types';

function _extends() {
  _extends_1 = _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

var _extends_1 = _extends;

var _extends$1 = _extends_1;

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

var defineProperty = _defineProperty;

function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}

var arrayWithHoles$1 = _arrayWithHoles;

function _iterableToArrayLimit(arr, i) {
  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
    return;
  }

  var _arr = [];
  var _n = true;
  var _d = false;
  var _e = undefined;

  try {
    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);

      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null) _i["return"]();
    } finally {
      if (_d) throw _e;
    }
  }

  return _arr;
}

var iterableToArrayLimit$1 = _iterableToArrayLimit;

function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance");
}

var nonIterableRest$1 = _nonIterableRest;

var arrayWithHoles = arrayWithHoles$1;

var iterableToArrayLimit = iterableToArrayLimit$1;

var nonIterableRest = nonIterableRest$1;

function _slicedToArray(arr, i) {
  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();
}

var slicedToArray = _slicedToArray;

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

var objectWithoutPropertiesLoose$1 = _objectWithoutPropertiesLoose;

var objectWithoutPropertiesLoose = objectWithoutPropertiesLoose$1;

function _objectWithoutProperties(source, excluded) {
  if (source == null) return {};
  var target = objectWithoutPropertiesLoose(source, excluded);
  var key, i;

  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);

    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }

  return target;
}

var objectWithoutProperties = _objectWithoutProperties;

var workerHelper = {};

Object.defineProperty(workerHelper, "__esModule", { value: true });
function createWorker$1(file) {
    var WebWorker = /** @class */ (function () {
        function WebWorker() {
            this._url = URL.createObjectURL(new Blob([file]));
            this._worker = new Worker(this._url);
        }
        WebWorker.prototype.dispatchEvent = function (event) {
            return this._worker.dispatchEvent(event);
        };
        WebWorker.prototype.addEventListener = function (type, listener, options) {
            this._worker.addEventListener(type, listener, options);
        };
        WebWorker.prototype.removeEventListener = function (type, listener, options) {
            this._worker.removeEventListener(type, listener, options);
        };
        WebWorker.prototype.postMessage = function (message, options) {
            this._worker.postMessage(message, options);
        };
        WebWorker.prototype.terminate = function () {
            this._worker.terminate();
            URL.revokeObjectURL(this._url);
        };
        Object.defineProperty(WebWorker.prototype, "onmessage", {
            get: function () {
                return this._worker.onmessage;
            },
            set: function (e) {
                this._worker.onmessage = e;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(WebWorker.prototype, "onerror", {
            get: function () {
                return this._worker.onerror;
            },
            set: function (e) {
                this._worker.onerror = e;
            },
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(WebWorker.prototype, "onmessageerror", {
            get: function () {
                return this._worker.onmessageerror;
            },
            set: function (e) {
                this._worker.onmessageerror = e;
            },
            enumerable: false,
            configurable: true
        });
        return WebWorker;
    }());
    return WebWorker;
}
var _default = workerHelper.default = createWorker$1;

var WebWorker = _default("!function(){\"use strict\";var t=\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:{};function e(t){var e=t.default;if(\"function\"==typeof e){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,\"__esModule\",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),r}var r={},n={},o={};function a(t,e){void 0===e&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var i,u=(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},i(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f=function(t){function e(e){var r,n,o,i=this.constructor,u=t.call(this,e)||this;return Object.defineProperty(u,\"name\",{value:i.name,enumerable:!1,configurable:!0}),r=u,n=i.prototype,(o=Object.setPrototypeOf)?o(r,n):r.__proto__=n,a(u),u}return u(e,t),e}(Error),l=function(){for(var t=arguments,e=0,r=0,n=arguments.length;r<n;r++)e+=t[r].length;var o=Array(e),a=0;for(r=0;r<n;r++)for(var i=arguments[r],u=0,f=i.length;u<f;u++,a++)o[a]=i[u];return o};var s=Object.freeze({__proto__:null,CustomError:f,customErrorFactory:function(t,e){function r(){for(var n=arguments,o=[],i=0;i<arguments.length;i++)o[i]=n[i];if(!(this instanceof r))return new(r.bind.apply(r,l([void 0],o)));e.apply(this,o),Object.defineProperty(this,\"name\",{value:t.name||e.name,enumerable:!1,configurable:!0}),t.apply(this,o),a(this,r)}return void 0===e&&(e=Error),Object.defineProperties(r,{prototype:{value:Object.create(e.prototype,{constructor:{value:r,writable:!0,configurable:!0}})}})}}),d=e(s),c=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(o,\"__esModule\",{value:!0});var h=function(t){function e(e){void 0===e&&(e=void 0);var r=t.call(this,e)||this;return r.message=e,r}return c(e,t),e.prototype.getKind=function(){return this.constructor.kind},e.kind=\"Exception\",e}(d.CustomError);o.default=h;var p=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(n,\"__esModule\",{value:!0});var w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.kind=\"IllegalArgumentException\",e}(o.default);n.default=w,Object.defineProperty(r,\"__esModule\",{value:!0});var y=n,_=function(){function t(t){if(this.binarizer=t,null===t)throw new y.default(\"Binarizer must be non-null.\")}return t.prototype.getWidth=function(){return this.binarizer.getWidth()},t.prototype.getHeight=function(){return this.binarizer.getHeight()},t.prototype.getBlackRow=function(t,e){return this.binarizer.getBlackRow(t,e)},t.prototype.getBlackMatrix=function(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},t.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},t.prototype.crop=function(e,r,n,o){var a=this.binarizer.getLuminanceSource().crop(e,r,n,o);return new t(this.binarizer.createBinarizer(a))},t.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},t.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new t(this.binarizer.createBinarizer(e))},t.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new t(this.binarizer.createBinarizer(e))},t.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch(t){return\"\"}},t}(),g=r.default=_,v={},S={},A={};Object.defineProperty(A,\"__esModule\",{value:!0});var m=function(){function t(t){this.source=t}return t.prototype.getLuminanceSource=function(){return this.source},t.prototype.getWidth=function(){return this.source.getWidth()},t.prototype.getHeight=function(){return this.source.getHeight()},t}();A.default=m;var I={},O={},C={};Object.defineProperty(C,\"__esModule\",{value:!0});var b=function(){function t(){}return t.arraycopy=function(t,e,r,n,o){for(;o--;)r[n++]=t[e++]},t.currentTimeMillis=function(){return Date.now()},t}();C.default=b;var E={},M={},N=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(M,\"__esModule\",{value:!0});var T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.kind=\"IndexOutOfBoundsException\",e}(o.default);M.default=T;var P=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(E,\"__esModule\",{value:!0});var B=function(t){function e(e,r){void 0===e&&(e=void 0),void 0===r&&(r=void 0);var n=t.call(this,r)||this;return n.index=e,n.message=r,n}return P(e,t),e.kind=\"ArrayIndexOutOfBoundsException\",e}(M.default);E.default=B;var R=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(O,\"__esModule\",{value:!0});var D=C,k=n,U=E,x=function(){function t(){}return t.fill=function(t,e){for(var r=0,n=t.length;r<n;r++)t[r]=e},t.fillWithin=function(e,r,n,o){t.rangeCheck(e.length,r,n);for(var a=r;a<n;a++)e[a]=o},t.rangeCheck=function(t,e,r){if(e>r)throw new k.default(\"fromIndex(\"+e+\") > toIndex(\"+r+\")\");if(e<0)throw new U.default(e);if(r>t)throw new U.default(r)},t.asList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t},t.create=function(t,e,r){return Array.from({length:t}).map((function(t){return Array.from({length:e}).fill(r)}))},t.createInt32Array=function(t,e,r){return Array.from({length:t}).map((function(t){return Int32Array.from({length:e}).fill(r)}))},t.equals=function(t,e){if(!t)return!1;if(!e)return!1;if(!t.length)return!1;if(!e.length)return!1;if(t.length!==e.length)return!1;for(var r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0},t.hashCode=function(t){var e,r;if(null===t)return 0;var n=1;try{for(var o=R(t),a=o.next();!a.done;a=o.next()){n=31*n+a.value}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},t.fillUint8Array=function(t,e){for(var r=0;r!==t.length;r++)t[r]=e},t.copyOf=function(t,e){return t.slice(0,e)},t.copyOfUint8Array=function(t,e){if(t.length<=e){var r=new Uint8Array(e);return r.set(t),r}return t.slice(0,e)},t.copyOfRange=function(t,e,r){var n=r-e,o=new Int32Array(n);return D.default.arraycopy(t,e,o,0,n),o},t.binarySearch=function(e,r,n){void 0===n&&(n=t.numberComparator);for(var o=0,a=e.length-1;o<=a;){var i=a+o>>1,u=n(r,e[i]);if(u>0)o=i+1;else{if(!(u<0))return i;a=i-1}}return-o-1},t.numberComparator=function(t,e){return t-e},t}();O.default=x;var F={};Object.defineProperty(F,\"__esModule\",{value:!0});var L=function(){function t(){}return t.numberOfTrailingZeros=function(t){var e;if(0===t)return 32;var r=31;return 0!==(e=t<<16)&&(r-=16,t=e),0!==(e=t<<8)&&(r-=8,t=e),0!==(e=t<<4)&&(r-=4,t=e),0!==(e=t<<2)&&(r-=2,t=e),r-(t<<1>>>31)},t.numberOfLeadingZeros=function(t){if(0===t)return 32;var e=1;return t>>>16==0&&(e+=16,t<<=16),t>>>24==0&&(e+=8,t<<=8),t>>>28==0&&(e+=4,t<<=4),t>>>30==0&&(e+=2,t<<=2),e-=t>>>31},t.toHexString=function(t){return t.toString(16)},t.toBinaryString=function(t){return String(parseInt(String(t),2))},t.bitCount=function(t){return t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135,t+=t>>>8,63&(t+=t>>>16)},t.truncDivision=function(t,e){return Math.trunc(t/e)},t.parseInt=function(t,e){return void 0===e&&(e=void 0),parseInt(t,e)},t.MIN_VALUE_32_BITS=-2147483648,t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}();F.default=L,Object.defineProperty(I,\"__esModule\",{value:!0});var j=n,z=O,H=F,K=C,V=function(){function t(e,r){void 0===e?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=null==r?t.makeArray(e):r)}return t.prototype.getSize=function(){return this.size},t.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},t.prototype.ensureCapacity=function(e){if(e>32*this.bits.length){var r=t.makeArray(e);K.default.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},t.prototype.get=function(t){return 0!=(this.bits[Math.floor(t/32)]&1<<(31&t))},t.prototype.set=function(t){this.bits[Math.floor(t/32)]|=1<<(31&t)},t.prototype.flip=function(t){this.bits[Math.floor(t/32)]^=1<<(31&t)},t.prototype.getNextSet=function(t){var e=this.size;if(t>=e)return e;var r=this.bits,n=Math.floor(t/32),o=r[n];o&=~((1<<(31&t))-1);for(var a=r.length;0===o;){if(++n===a)return e;o=r[n]}var i=32*n+H.default.numberOfTrailingZeros(o);return i>e?e:i},t.prototype.getNextUnset=function(t){var e=this.size;if(t>=e)return e;var r=this.bits,n=Math.floor(t/32),o=~r[n];o&=~((1<<(31&t))-1);for(var a=r.length;0===o;){if(++n===a)return e;o=~r[n]}var i=32*n+H.default.numberOfTrailingZeros(o);return i>e?e:i},t.prototype.setBulk=function(t,e){this.bits[Math.floor(t/32)]=e},t.prototype.setRange=function(t,e){if(e<t||t<0||e>this.size)throw new j.default;if(e!==t){e--;for(var r=Math.floor(t/32),n=Math.floor(e/32),o=this.bits,a=r;a<=n;a++){var i=(2<<(a<n?31:31&e))-(1<<(a>r?0:31&t));o[a]|=i}}},t.prototype.clear=function(){for(var t=this.bits.length,e=this.bits,r=0;r<t;r++)e[r]=0},t.prototype.isRange=function(t,e,r){if(e<t||t<0||e>this.size)throw new j.default;if(e===t)return!0;e--;for(var n=Math.floor(t/32),o=Math.floor(e/32),a=this.bits,i=n;i<=o;i++){var u=(2<<(i<o?31:31&e))-(1<<(i>n?0:31&t))&4294967295;if((a[i]&u)!==(r?u:0))return!1}return!0},t.prototype.appendBit=function(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++},t.prototype.appendBits=function(t,e){if(e<0||e>32)throw new j.default(\"Num bits must be between 0 and 32\");this.ensureCapacity(this.size+e);for(var r=e;r>0;r--)this.appendBit(1==(t>>r-1&1))},t.prototype.appendBitArray=function(t){var e=t.size;this.ensureCapacity(this.size+e);for(var r=0;r<e;r++)this.appendBit(t.get(r))},t.prototype.xor=function(t){if(this.size!==t.size)throw new j.default(\"Sizes don't match\");for(var e=this.bits,r=0,n=e.length;r<n;r++)e[r]^=t.bits[r]},t.prototype.toBytes=function(t,e,r,n){for(var o=0;o<n;o++){for(var a=0,i=0;i<8;i++)this.get(t)&&(a|=1<<7-i),t++;e[r+o]=a}},t.prototype.getBitArray=function(){return this.bits},t.prototype.reverse=function(){for(var t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),r=e+1,n=this.bits,o=0;o<r;o++){var a=n[o];a=(a=(a=(a=(a=a>>1&1431655765|(1431655765&a)<<1)>>2&858993459|(858993459&a)<<2)>>4&252645135|(252645135&a)<<4)>>8&16711935|(16711935&a)<<8)>>16&65535|(65535&a)<<16,t[e-o]=a}if(this.size!==32*r){var i=32*r-this.size,u=t[0]>>>i;for(o=1;o<r;o++){var f=t[o];u|=f<<32-i,t[o-1]=u,u=f>>>i}t[r-1]=u}this.bits=t},t.makeArray=function(t){return new Int32Array(Math.floor((t+31)/32))},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.size===r.size&&z.default.equals(this.bits,r.bits)},t.prototype.hashCode=function(){return 31*this.size+z.default.hashCode(this.bits)},t.prototype.toString=function(){for(var t=\"\",e=0,r=this.size;e<r;e++)0==(7&e)&&(t+=\" \"),t+=this.get(e)?\"X\":\".\";return t},t.prototype.clone=function(){return new t(this.size,this.bits.slice())},t}();I.default=V;var W,Z={},G={},X={},Y={};Object.defineProperty(Y,\"__esModule\",{value:!0}),function(t){t[t.OTHER=0]=\"OTHER\",t[t.PURE_BARCODE=1]=\"PURE_BARCODE\",t[t.POSSIBLE_FORMATS=2]=\"POSSIBLE_FORMATS\",t[t.TRY_HARDER=3]=\"TRY_HARDER\",t[t.CHARACTER_SET=4]=\"CHARACTER_SET\",t[t.ALLOWED_LENGTHS=5]=\"ALLOWED_LENGTHS\",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]=\"ASSUME_CODE_39_CHECK_DIGIT\",t[t.ASSUME_GS1=7]=\"ASSUME_GS1\",t[t.RETURN_CODABAR_START_END=8]=\"RETURN_CODABAR_START_END\",t[t.NEED_RESULT_POINT_CALLBACK=9]=\"NEED_RESULT_POINT_CALLBACK\",t[t.ALLOWED_EAN_EXTENSIONS=10]=\"ALLOWED_EAN_EXTENSIONS\"}(W||(W={})),Y.default=W;var q={},Q={},J=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Q,\"__esModule\",{value:!0});var $=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return J(e,t),e.getFormatInstance=function(){return new e},e.kind=\"FormatException\",e}(o.default);Q.default=$,function(e){var r=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(e,\"__esModule\",{value:!0}),e.CharacterSetValueIdentifiers=void 0;var n,o=Q;!function(t){t[t.Cp437=0]=\"Cp437\",t[t.ISO8859_1=1]=\"ISO8859_1\",t[t.ISO8859_2=2]=\"ISO8859_2\",t[t.ISO8859_3=3]=\"ISO8859_3\",t[t.ISO8859_4=4]=\"ISO8859_4\",t[t.ISO8859_5=5]=\"ISO8859_5\",t[t.ISO8859_6=6]=\"ISO8859_6\",t[t.ISO8859_7=7]=\"ISO8859_7\",t[t.ISO8859_8=8]=\"ISO8859_8\",t[t.ISO8859_9=9]=\"ISO8859_9\",t[t.ISO8859_10=10]=\"ISO8859_10\",t[t.ISO8859_11=11]=\"ISO8859_11\",t[t.ISO8859_13=12]=\"ISO8859_13\",t[t.ISO8859_14=13]=\"ISO8859_14\",t[t.ISO8859_15=14]=\"ISO8859_15\",t[t.ISO8859_16=15]=\"ISO8859_16\",t[t.SJIS=16]=\"SJIS\",t[t.Cp1250=17]=\"Cp1250\",t[t.Cp1251=18]=\"Cp1251\",t[t.Cp1252=19]=\"Cp1252\",t[t.Cp1256=20]=\"Cp1256\",t[t.UnicodeBigUnmarked=21]=\"UnicodeBigUnmarked\",t[t.UTF8=22]=\"UTF8\",t[t.ASCII=23]=\"ASCII\",t[t.Big5=24]=\"Big5\",t[t.GB18030=25]=\"GB18030\",t[t.EUC_KR=26]=\"EUC_KR\"}(n=e.CharacterSetValueIdentifiers||(e.CharacterSetValueIdentifiers={}));var a=function(){function t(e,n,o){for(var a,i,u=[],f=3;f<arguments.length;f++)u[f-3]=arguments[f];this.valueIdentifier=e,this.name=o,this.values=\"number\"==typeof n?Int32Array.from([n]):n,this.otherEncodingNames=u,t.VALUE_IDENTIFIER_TO_ECI.set(e,this),t.NAME_TO_ECI.set(o,this);for(var l=this.values,s=0,d=l.length;s!==d;s++){var c=l[s];t.VALUES_TO_ECI.set(c,this)}try{for(var h=r(u),p=h.next();!p.done;p=h.next()){var w=p.value;t.NAME_TO_ECI.set(w,this)}}catch(t){a={error:t}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}}return t.prototype.getValueIdentifier=function(){return this.valueIdentifier},t.prototype.getName=function(){return this.name},t.prototype.getValue=function(){return this.values[0]},t.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new o.default(\"incorect value\");var r=t.VALUES_TO_ECI.get(e);if(void 0===r)throw new o.default(\"incorect value\");return r},t.getCharacterSetECIByName=function(e){var r=t.NAME_TO_ECI.get(e);if(void 0===r)throw new o.default(\"incorect value\");return r},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.getName()===r.getName()},t.VALUE_IDENTIFIER_TO_ECI=new Map,t.VALUES_TO_ECI=new Map,t.NAME_TO_ECI=new Map,t.Cp437=new t(n.Cp437,Int32Array.from([0,2]),\"Cp437\"),t.ISO8859_1=new t(n.ISO8859_1,Int32Array.from([1,3]),\"ISO-8859-1\",\"ISO88591\",\"ISO8859_1\"),t.ISO8859_2=new t(n.ISO8859_2,4,\"ISO-8859-2\",\"ISO88592\",\"ISO8859_2\"),t.ISO8859_3=new t(n.ISO8859_3,5,\"ISO-8859-3\",\"ISO88593\",\"ISO8859_3\"),t.ISO8859_4=new t(n.ISO8859_4,6,\"ISO-8859-4\",\"ISO88594\",\"ISO8859_4\"),t.ISO8859_5=new t(n.ISO8859_5,7,\"ISO-8859-5\",\"ISO88595\",\"ISO8859_5\"),t.ISO8859_6=new t(n.ISO8859_6,8,\"ISO-8859-6\",\"ISO88596\",\"ISO8859_6\"),t.ISO8859_7=new t(n.ISO8859_7,9,\"ISO-8859-7\",\"ISO88597\",\"ISO8859_7\"),t.ISO8859_8=new t(n.ISO8859_8,10,\"ISO-8859-8\",\"ISO88598\",\"ISO8859_8\"),t.ISO8859_9=new t(n.ISO8859_9,11,\"ISO-8859-9\",\"ISO88599\",\"ISO8859_9\"),t.ISO8859_10=new t(n.ISO8859_10,12,\"ISO-8859-10\",\"ISO885910\",\"ISO8859_10\"),t.ISO8859_11=new t(n.ISO8859_11,13,\"ISO-8859-11\",\"ISO885911\",\"ISO8859_11\"),t.ISO8859_13=new t(n.ISO8859_13,15,\"ISO-8859-13\",\"ISO885913\",\"ISO8859_13\"),t.ISO8859_14=new t(n.ISO8859_14,16,\"ISO-8859-14\",\"ISO885914\",\"ISO8859_14\"),t.ISO8859_15=new t(n.ISO8859_15,17,\"ISO-8859-15\",\"ISO885915\",\"ISO8859_15\"),t.ISO8859_16=new t(n.ISO8859_16,18,\"ISO-8859-16\",\"ISO885916\",\"ISO8859_16\"),t.SJIS=new t(n.SJIS,20,\"SJIS\",\"Shift_JIS\"),t.Cp1250=new t(n.Cp1250,21,\"Cp1250\",\"windows-1250\"),t.Cp1251=new t(n.Cp1251,22,\"Cp1251\",\"windows-1251\"),t.Cp1252=new t(n.Cp1252,23,\"Cp1252\",\"windows-1252\"),t.Cp1256=new t(n.Cp1256,24,\"Cp1256\",\"windows-1256\"),t.UnicodeBigUnmarked=new t(n.UnicodeBigUnmarked,25,\"UnicodeBigUnmarked\",\"UTF-16BE\",\"UnicodeBig\"),t.UTF8=new t(n.UTF8,26,\"UTF8\",\"UTF-8\"),t.ASCII=new t(n.ASCII,Int32Array.from([27,170]),\"ASCII\",\"US-ASCII\"),t.Big5=new t(n.Big5,28,\"Big5\"),t.GB18030=new t(n.GB18030,29,\"GB18030\",\"GB2312\",\"EUC_CN\",\"GBK\"),t.EUC_KR=new t(n.EUC_KR,30,\"EUC_KR\",\"EUC-KR\"),t}();e.default=a}(q);var tt={},et={},rt=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(et,\"__esModule\",{value:!0});var nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return rt(e,t),e.kind=\"UnsupportedOperationException\",e}(o.default);et.default=nt,Object.defineProperty(tt,\"__esModule\",{value:!0});var ot=et,at=q,it=function(){function t(){}return t.decode=function(t,e){var r=this.encodingName(e);return this.customDecoder?this.customDecoder(t,r):\"undefined\"==typeof TextDecoder||this.shouldDecodeOnFallback(r)?this.decodeFallback(t,r):new TextDecoder(r).decode(t)},t.shouldDecodeOnFallback=function(e){return!t.isBrowser()&&\"ISO-8859-1\"===e},t.encode=function(t,e){var r=this.encodingName(e);return this.customEncoder?this.customEncoder(t,r):\"undefined\"==typeof TextEncoder?this.encodeFallback(t):(new TextEncoder).encode(t)},t.isBrowser=function(){return\"undefined\"!=typeof window&&\"[object Window]\"==={}.toString.call(window)},t.encodingName=function(t){return\"string\"==typeof t?t:t.getName()},t.encodingCharacterSet=function(t){return t instanceof at.default?t:at.default.getCharacterSetECIByName(t)},t.decodeFallback=function(e,r){var n=this.encodingCharacterSet(r);if(t.isDecodeFallbackSupported(n)){for(var o=\"\",a=0,i=e.length;a<i;a++){var u=e[a].toString(16);u.length<2&&(u=\"0\"+u),o+=\"%\"+u}return decodeURIComponent(o)}if(n.equals(at.default.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new ot.default(\"Encoding \"+this.encodingName(r)+\" not supported by fallback.\")},t.isDecodeFallbackSupported=function(t){return t.equals(at.default.UTF8)||t.equals(at.default.ISO8859_1)||t.equals(at.default.ASCII)},t.encodeFallback=function(t){for(var e=btoa(unescape(encodeURIComponent(t))).split(\"\"),r=[],n=0;n<e.length;n++)r.push(e[n].charCodeAt(0));return new Uint8Array(r)},t}();tt.default=it,Object.defineProperty(X,\"__esModule\",{value:!0});var ut=Y,ft=q,lt=tt,st=function(){function t(){}return t.castAsNonUtf8Char=function(t,e){void 0===e&&(e=null);var r=e?e.getName():this.ISO88591;return lt.default.decode(new Uint8Array([t]),r)},t.guessEncoding=function(e,r){if(null!=r&&void 0!==r.get(ut.default.CHARACTER_SET))return r.get(ut.default.CHARACTER_SET).toString();for(var n=e.length,o=!0,a=!0,i=!0,u=0,f=0,l=0,s=0,d=0,c=0,h=0,p=0,w=0,y=0,_=0,g=e.length>3&&239===e[0]&&187===e[1]&&191===e[2],v=0;v<n&&(o||a||i);v++){var S=255&e[v];i&&(u>0?0==(128&S)?i=!1:u--:0!=(128&S)&&(0==(64&S)?i=!1:(u++,0==(32&S)?f++:(u++,0==(16&S)?l++:(u++,0==(8&S)?s++:i=!1))))),o&&(S>127&&S<160?o=!1:S>159&&(S<192||215===S||247===S)&&_++),a&&(d>0?S<64||127===S||S>252?a=!1:d--:128===S||160===S||S>239?a=!1:S>160&&S<224?(c++,p=0,++h>w&&(w=h)):S>127?(d++,h=0,++p>y&&(y=p)):(h=0,p=0))}return i&&u>0&&(i=!1),a&&d>0&&(a=!1),i&&(g||f+l+s>0)?t.UTF8:a&&(t.ASSUME_SHIFT_JIS||w>=3||y>=3)?t.SHIFT_JIS:o&&a?2===w&&2===c||10*_>=n?t.SHIFT_JIS:t.ISO88591:o?t.ISO88591:a?t.SHIFT_JIS:i?t.UTF8:t.PLATFORM_DEFAULT_ENCODING},t.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=-1;function o(t,r,o,a,i,u){if(\"%%\"===t)return\"%\";if(void 0!==e[++n]){t=a?parseInt(a.substr(1)):void 0;var f,l=i?parseInt(i.substr(1)):void 0;switch(u){case\"s\":f=e[n];break;case\"c\":f=e[n][0];break;case\"f\":f=parseFloat(e[n]).toFixed(t);break;case\"p\":f=parseFloat(e[n]).toPrecision(t);break;case\"e\":f=parseFloat(e[n]).toExponential(t);break;case\"x\":f=parseInt(e[n]).toString(l||16);break;case\"d\":f=parseFloat(parseInt(e[n],l||10).toPrecision(t)).toFixed(0)}f=\"object\"==typeof f?JSON.stringify(f):(+f).toString(l);for(var s=parseInt(o),d=o&&o[0]+\"\"==\"0\"?\"0\":\" \";f.length<s;)f=void 0!==r?f+d:d+f;return f}}var a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(a,o)},t.getBytes=function(t,e){return lt.default.encode(t,e)},t.getCharCode=function(t,e){return void 0===e&&(e=0),t.charCodeAt(e)},t.getCharAt=function(t){return String.fromCharCode(t)},t.SHIFT_JIS=ft.default.SJIS.getName(),t.GB2312=\"GB2312\",t.ISO88591=ft.default.ISO8859_1.getName(),t.EUC_JP=\"EUC_JP\",t.UTF8=ft.default.UTF8.getName(),t.PLATFORM_DEFAULT_ENCODING=t.UTF8,t.ASSUME_SHIFT_JIS=!1,t}();X.default=st,Object.defineProperty(G,\"__esModule\",{value:!0});var dt=X,ct=function(){function t(t){void 0===t&&(t=\"\"),this.value=t}return t.prototype.enableDecoding=function(t){return this.encoding=t,this},t.prototype.append=function(t){return\"string\"==typeof t?this.value+=t.toString():this.encoding?this.value+=dt.default.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this},t.prototype.appendChars=function(t,e,r){for(var n=e;e<e+r;n++)this.append(t[n]);return this},t.prototype.length=function(){return this.value.length},t.prototype.charAt=function(t){return this.value.charAt(t)},t.prototype.deleteCharAt=function(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)},t.prototype.setCharAt=function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)},t.prototype.substring=function(t,e){return this.value.substring(t,e)},t.prototype.setLengthToZero=function(){this.value=\"\"},t.prototype.toString=function(){return this.value},t.prototype.insert=function(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+e.length)},t}();G.default=ct,Object.defineProperty(Z,\"__esModule\",{value:!0});var ht=I,pt=C,wt=O,yt=G,_t=n,gt=function(){function t(t,e,r,n){if(this.width=t,this.height=e,this.rowSize=r,this.bits=n,null==e&&(e=t),this.height=e,t<1||e<1)throw new _t.default(\"Both dimensions must be greater than 0\");null==r&&(r=Math.floor((t+31)/32)),this.rowSize=r,null==n&&(this.bits=new Int32Array(this.rowSize*this.height))}return t.parseFromBooleanArray=function(e){for(var r=e.length,n=e[0].length,o=new t(n,r),a=0;a<r;a++)for(var i=e[a],u=0;u<n;u++)i[u]&&o.set(u,a);return o},t.parseFromString=function(e,r,n){if(null===e)throw new _t.default(\"stringRepresentation cannot be null\");for(var o=new Array(e.length),a=0,i=0,u=-1,f=0,l=0;l<e.length;)if(\"\\n\"===e.charAt(l)||\"\\r\"===e.charAt(l)){if(a>i){if(-1===u)u=a-i;else if(a-i!==u)throw new _t.default(\"row lengths do not match\");i=a,f++}l++}else if(e.substring(l,l+r.length)===r)l+=r.length,o[a]=!0,a++;else{if(e.substring(l,l+n.length)!==n)throw new _t.default(\"illegal character encountered: \"+e.substring(l));l+=n.length,o[a]=!1,a++}if(a>i){if(-1===u)u=a-i;else if(a-i!==u)throw new _t.default(\"row lengths do not match\");f++}for(var s=new t(u,f),d=0;d<a;d++)o[d]&&s.set(Math.floor(d%u),Math.floor(d/u));return s},t.prototype.get=function(t,e){var r=e*this.rowSize+Math.floor(t/32);return 0!=(this.bits[r]>>>(31&t)&1)},t.prototype.set=function(t,e){var r=e*this.rowSize+Math.floor(t/32);this.bits[r]|=1<<(31&t)&4294967295},t.prototype.unset=function(t,e){var r=e*this.rowSize+Math.floor(t/32);this.bits[r]&=~(1<<(31&t)&4294967295)},t.prototype.flip=function(t,e){var r=e*this.rowSize+Math.floor(t/32);this.bits[r]^=1<<(31&t)&4294967295},t.prototype.xor=function(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new _t.default(\"input matrix dimensions do not match\");for(var e=new ht.default(Math.floor(this.width/32)+1),r=this.rowSize,n=this.bits,o=0,a=this.height;o<a;o++)for(var i=o*r,u=t.getRow(o,e).getBitArray(),f=0;f<r;f++)n[i+f]^=u[f]},t.prototype.clear=function(){for(var t=this.bits,e=t.length,r=0;r<e;r++)t[r]=0},t.prototype.setRegion=function(t,e,r,n){if(e<0||t<0)throw new _t.default(\"Left and top must be nonnegative\");if(n<1||r<1)throw new _t.default(\"Height and width must be at least 1\");var o=t+r,a=e+n;if(a>this.height||o>this.width)throw new _t.default(\"The region must fit inside the matrix\");for(var i=this.rowSize,u=this.bits,f=e;f<a;f++)for(var l=f*i,s=t;s<o;s++)u[l+Math.floor(s/32)]|=1<<(31&s)&4294967295},t.prototype.getRow=function(t,e){null==e||e.getSize()<this.width?e=new ht.default(this.width):e.clear();for(var r=this.rowSize,n=this.bits,o=t*r,a=0;a<r;a++)e.setBulk(32*a,n[o+a]);return e},t.prototype.setRow=function(t,e){pt.default.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)},t.prototype.rotate180=function(){for(var t=this.getWidth(),e=this.getHeight(),r=new ht.default(t),n=new ht.default(t),o=0,a=Math.floor((e+1)/2);o<a;o++)r=this.getRow(o,r),n=this.getRow(e-1-o,n),r.reverse(),n.reverse(),this.setRow(o,n),this.setRow(e-1-o,r)},t.prototype.getEnclosingRectangle=function(){for(var t=this.width,e=this.height,r=this.rowSize,n=this.bits,o=t,a=e,i=-1,u=-1,f=0;f<e;f++)for(var l=0;l<r;l++){var s=n[f*r+l];if(0!==s){if(f<a&&(a=f),f>u&&(u=f),32*l<o){for(var d=0;0==(s<<31-d&4294967295);)d++;32*l+d<o&&(o=32*l+d)}if(32*l+31>i){for(d=31;s>>>d==0;)d--;32*l+d>i&&(i=32*l+d)}}}return i<o||u<a?null:Int32Array.from([o,a,i-o+1,u-a+1])},t.prototype.getTopLeftOnBit=function(){for(var t=this.rowSize,e=this.bits,r=0;r<e.length&&0===e[r];)r++;if(r===e.length)return null;for(var n=r/t,o=r%t*32,a=e[r],i=0;0==(a<<31-i&4294967295);)i++;return o+=i,Int32Array.from([o,n])},t.prototype.getBottomRightOnBit=function(){for(var t=this.rowSize,e=this.bits,r=e.length-1;r>=0&&0===e[r];)r--;if(r<0)return null;for(var n=Math.floor(r/t),o=32*Math.floor(r%t),a=e[r],i=31;a>>>i==0;)i--;return o+=i,Int32Array.from([o,n])},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getRowSize=function(){return this.rowSize},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&wt.default.equals(this.bits,r.bits)},t.prototype.hashCode=function(){var t=this.width;return t=31*(t=31*(t=31*(t=31*t+this.width)+this.height)+this.rowSize)+wt.default.hashCode(this.bits)},t.prototype.toString=function(t,e,r){return void 0===t&&(t=\"X \"),void 0===e&&(e=\"  \"),void 0===r&&(r=\"\\n\"),this.buildToString(t,e,r)},t.prototype.buildToString=function(t,e,r){for(var n=new yt.default,o=0,a=this.height;o<a;o++){for(var i=0,u=this.width;i<u;i++)n.append(this.get(i,o)?t:e);n.append(r)}return n.toString()},t.prototype.clone=function(){return new t(this.width,this.height,this.rowSize,this.bits.slice())},t}();Z.default=gt;var vt={},St=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(vt,\"__esModule\",{value:!0});var At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return St(e,t),e.getNotFoundInstance=function(){return new e},e.kind=\"NotFoundException\",e}(o.default);vt.default=At;var mt=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(S,\"__esModule\",{value:!0});var It=I,Ot=Z,Ct=vt,bt=function(t){function e(r){var n=t.call(this,r)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return mt(e,t),e.prototype.getBlackRow=function(t,r){var n=this.getLuminanceSource(),o=n.getWidth();null==r||r.getSize()<o?r=new It.default(o):r.clear(),this.initArrays(o);for(var a=n.getRow(t,this.luminances),i=this.buckets,u=0;u<o;u++)i[(255&a[u])>>e.LUMINANCE_SHIFT]++;var f=e.estimateBlackPoint(i);if(o<3)for(u=0;u<o;u++)(255&a[u])<f&&r.set(u);else{var l=255&a[0],s=255&a[1];for(u=1;u<o-1;u++){var d=255&a[u+1];(4*s-l-d)/2<f&&r.set(u),l=s,s=d}}return r},e.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),r=t.getWidth(),n=t.getHeight(),o=new Ot.default(r,n);this.initArrays(r);for(var a=this.buckets,i=1;i<5;i++)for(var u=Math.floor(n*i/5),f=t.getRow(u,this.luminances),l=Math.floor(4*r/5),s=Math.floor(r/5);s<l;s++){a[(255&f[s])>>e.LUMINANCE_SHIFT]++}var d=e.estimateBlackPoint(a),c=t.getMatrix();for(i=0;i<n;i++){var h=i*r;for(s=0;s<r;s++){(255&c[h+s])<d&&o.set(s,i)}}return o},e.prototype.createBinarizer=function(t){return new e(t)},e.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var r=this.buckets,n=0;n<e.LUMINANCE_BUCKETS;n++)r[n]=0},e.estimateBlackPoint=function(t){for(var r=t.length,n=0,o=0,a=0,i=0;i<r;i++)t[i]>a&&(o=i,a=t[i]),t[i]>n&&(n=t[i]);var u=0,f=0;for(i=0;i<r;i++){var l=i-o;(h=t[i]*l*l)>f&&(u=i,f=h)}if(o>u){var s=o;o=u,u=s}if(u-o<=r/16)throw new Ct.default;var d=u-1,c=-1;for(i=u-1;i>o;i--){var h,p=i-o;(h=p*p*(u-i)*(n-t[i]))>c&&(d=i,c=h)}return d<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(A.default);S.default=bt;var Et=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(v,\"__esModule\",{value:!0});var Mt=Z,Nt=function(t){function e(e){var r=t.call(this,e)||this;return r.matrix=null,r}return Et(e,t),e.prototype.getBlackMatrix=function(){if(null!==this.matrix)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),o=r.getHeight();if(n>=e.MINIMUM_DIMENSION&&o>=e.MINIMUM_DIMENSION){var a=r.getMatrix(),i=n>>e.BLOCK_SIZE_POWER;0!=(n&e.BLOCK_SIZE_MASK)&&i++;var u=o>>e.BLOCK_SIZE_POWER;0!=(o&e.BLOCK_SIZE_MASK)&&u++;var f=e.calculateBlackPoints(a,i,u,n,o),l=new Mt.default(n,o);e.calculateThresholdForBlock(a,i,u,n,o,f,l),this.matrix=l}else this.matrix=t.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(t){return new e(t)},e.calculateThresholdForBlock=function(t,r,n,o,a,i,u){for(var f=a-e.BLOCK_SIZE,l=o-e.BLOCK_SIZE,s=0;s<n;s++){var d=s<<e.BLOCK_SIZE_POWER;d>f&&(d=f);for(var c=e.cap(s,2,n-3),h=0;h<r;h++){var p=h<<e.BLOCK_SIZE_POWER;p>l&&(p=l);for(var w=e.cap(h,2,r-3),y=0,_=-2;_<=2;_++){var g=i[c+_];y+=g[w-2]+g[w-1]+g[w]+g[w+1]+g[w+2]}var v=y/25;e.thresholdBlock(t,p,d,v,o,u)}}},e.cap=function(t,e,r){return t<e?e:t>r?r:t},e.thresholdBlock=function(t,r,n,o,a,i){for(var u=0,f=n*a+r;u<e.BLOCK_SIZE;u++,f+=a)for(var l=0;l<e.BLOCK_SIZE;l++)(255&t[f+l])<=o&&i.set(r+l,n+u)},e.calculateBlackPoints=function(t,r,n,o,a){for(var i=a-e.BLOCK_SIZE,u=o-e.BLOCK_SIZE,f=new Array(n),l=0;l<n;l++){f[l]=new Int32Array(r);var s=l<<e.BLOCK_SIZE_POWER;s>i&&(s=i);for(var d=0;d<r;d++){var c=d<<e.BLOCK_SIZE_POWER;c>u&&(c=u);for(var h=0,p=255,w=0,y=0,_=s*o+c;y<e.BLOCK_SIZE;y++,_+=o){for(var g=0;g<e.BLOCK_SIZE;g++){var v=255&t[_+g];h+=v,v<p&&(p=v),v>w&&(w=v)}if(w-p>e.MIN_DYNAMIC_RANGE)for(y++,_+=o;y<e.BLOCK_SIZE;y++,_+=o)for(g=0;g<e.BLOCK_SIZE;g++)h+=255&t[_+g]}var S=h>>2*e.BLOCK_SIZE_POWER;if(w-p<=e.MIN_DYNAMIC_RANGE&&(S=p/2,l>0&&d>0)){var A=(f[l-1][d]+2*f[l][d-1]+f[l-1][d-1])/4;p<A&&(S=A)}f[l][d]=S}}return f},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=5*e.BLOCK_SIZE,e.MIN_DYNAMIC_RANGE=24,e}(S.default),Tt=v.default=Nt,Pt={},Bt={},Rt={};Object.defineProperty(Rt,\"__esModule\",{value:!0});var Dt=G,kt=et,Ut=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.isCropSupported=function(){return!1},t.prototype.crop=function(t,e,r,n){throw new kt.default(\"This luminance source does not support cropping.\")},t.prototype.isRotateSupported=function(){return!1},t.prototype.rotateCounterClockwise=function(){throw new kt.default(\"This luminance source does not support rotation by 90 degrees.\")},t.prototype.rotateCounterClockwise45=function(){throw new kt.default(\"This luminance source does not support rotation by 45 degrees.\")},t.prototype.toString=function(){for(var t=new Uint8ClampedArray(this.width),e=new Dt.default,r=0;r<this.height;r++){for(var n=this.getRow(r,t),o=0;o<this.width;o++){var a=255&n[o],i=void 0;i=a<64?\"#\":a<128?\"+\":a<192?\".\":\" \",e.append(i)}e.append(\"\\n\")}return e.toString()},t}();Rt.default=Ut;var xt=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Bt,\"__esModule\",{value:!0});var Ft=function(t){function e(e){var r=t.call(this,e.getWidth(),e.getHeight())||this;return r.delegate=e,r}return xt(e,t),e.prototype.getRow=function(t,e){for(var r=this.delegate.getRow(t,e),n=this.getWidth(),o=0;o<n;o++)r[o]=255-(255&r[o]);return r},e.prototype.getMatrix=function(){for(var t=this.delegate.getMatrix(),e=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(e),n=0;n<e;n++)r[n]=255-(255&t[n]);return r},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(t,r,n,o){return new e(this.delegate.crop(t,r,n,o))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Rt.default);Bt.default=Ft;var Lt=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Pt,\"__esModule\",{value:!0});var jt,zt=Bt,Ht=C,Kt=n,Vt=function(t){function e(e,r,n,o,a,i,u){var f=t.call(this,r,n)||this;if(f.dataWidth=o,f.dataHeight=a,f.left=i,f.top=u,4===e.BYTES_PER_ELEMENT){for(var l=r*n,s=new Uint8ClampedArray(l),d=0;d<l;d++){var c=e[d],h=c>>16&255,p=c>>7&510,w=255&c;s[d]=(h+p+w)/4&255}f.luminances=s}else f.luminances=e;if(void 0===o&&(f.dataWidth=r),void 0===a&&(f.dataHeight=n),void 0===i&&(f.left=0),void 0===u&&(f.top=0),f.left+r>f.dataWidth||f.top+n>f.dataHeight)throw new Kt.default(\"Crop rectangle does not fit within image data.\");return f}return Lt(e,t),e.prototype.getRow=function(t,e){if(t<0||t>=this.getHeight())throw new Kt.default(\"Requested row is outside the image: \"+t);var r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));var n=(t+this.top)*this.dataWidth+this.left;return Ht.default.arraycopy(this.luminances,n,e,0,r),e},e.prototype.getMatrix=function(){var t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.luminances;var r=t*e,n=new Uint8ClampedArray(r),o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return Ht.default.arraycopy(this.luminances,o,n,0,r),n;for(var a=0;a<e;a++){var i=a*t;Ht.default.arraycopy(this.luminances,o,n,i,t),o+=this.dataWidth}return n},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,r,n,o){return new e(this.luminances,n,o,this.dataWidth,this.dataHeight,this.left+t,this.top+r)},e.prototype.invert=function(){return new zt.default(this)},e}(Rt.default),Wt=Pt.default=Vt,Zt={},Gt={};Object.defineProperty(Gt,\"__esModule\",{value:!0}),function(t){t[t.AZTEC=0]=\"AZTEC\",t[t.CODABAR=1]=\"CODABAR\",t[t.CODE_39=2]=\"CODE_39\",t[t.CODE_93=3]=\"CODE_93\",t[t.CODE_128=4]=\"CODE_128\",t[t.DATA_MATRIX=5]=\"DATA_MATRIX\",t[t.EAN_8=6]=\"EAN_8\",t[t.EAN_13=7]=\"EAN_13\",t[t.ITF=8]=\"ITF\",t[t.MAXICODE=9]=\"MAXICODE\",t[t.PDF_417=10]=\"PDF_417\",t[t.QR_CODE=11]=\"QR_CODE\",t[t.RSS_14=12]=\"RSS_14\",t[t.RSS_EXPANDED=13]=\"RSS_EXPANDED\",t[t.UPC_A=14]=\"UPC_A\",t[t.UPC_E=15]=\"UPC_E\",t[t.UPC_EAN_EXTENSION=16]=\"UPC_EAN_EXTENSION\"}(jt||(jt={})),Gt.default=jt;var Xt={};Object.defineProperty(Xt,\"__esModule\",{value:!0});var Yt=C,qt=function(){function t(t,e,r,n,o,a){void 0===r&&(r=null==e?0:8*e.length),void 0===a&&(a=Yt.default.currentTimeMillis()),this.text=t,this.rawBytes=e,this.numBits=r,this.resultPoints=n,this.format=o,this.timestamp=a,this.text=t,this.rawBytes=e,this.numBits=null==r?null==e?0:8*e.length:r,this.resultPoints=n,this.format=o,this.resultMetadata=null,this.timestamp=null==a?Yt.default.currentTimeMillis():a}return t.prototype.getText=function(){return this.text},t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.getResultPoints=function(){return this.resultPoints},t.prototype.getBarcodeFormat=function(){return this.format},t.prototype.getResultMetadata=function(){return this.resultMetadata},t.prototype.putMetadata=function(t,e){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)},t.prototype.putAllMetadata=function(t){null!==t&&(null===this.resultMetadata?this.resultMetadata=t:this.resultMetadata=new Map(t))},t.prototype.addResultPoints=function(t){var e=this.resultPoints;if(null===e)this.resultPoints=t;else if(null!==t&&t.length>0){var r=new Array(e.length+t.length);Yt.default.arraycopy(e,0,r,0,e.length),Yt.default.arraycopy(t,0,r,e.length,t.length),this.resultPoints=r}},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.toString=function(){return this.text},t}();Xt.default=qt;var Qt,Jt={};Object.defineProperty(Jt,\"__esModule\",{value:!0}),function(t){t[t.OTHER=0]=\"OTHER\",t[t.ORIENTATION=1]=\"ORIENTATION\",t[t.BYTE_SEGMENTS=2]=\"BYTE_SEGMENTS\",t[t.ERROR_CORRECTION_LEVEL=3]=\"ERROR_CORRECTION_LEVEL\",t[t.ISSUE_NUMBER=4]=\"ISSUE_NUMBER\",t[t.SUGGESTED_PRICE=5]=\"SUGGESTED_PRICE\",t[t.POSSIBLE_COUNTRY=6]=\"POSSIBLE_COUNTRY\",t[t.UPC_EAN_EXTENSION=7]=\"UPC_EAN_EXTENSION\",t[t.PDF417_EXTRA_METADATA=8]=\"PDF417_EXTRA_METADATA\",t[t.STRUCTURED_APPEND_SEQUENCE=9]=\"STRUCTURED_APPEND_SEQUENCE\",t[t.STRUCTURED_APPEND_PARITY=10]=\"STRUCTURED_APPEND_PARITY\"}(Qt||(Qt={})),Jt.default=Qt;var $t={},te={},ee=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(te,\"__esModule\",{value:!0});var re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ee(e,t),e.getChecksumInstance=function(){return new e},e.kind=\"ChecksumException\",e}(o.default);te.default=re;var ne={},oe={},ae={};Object.defineProperty(ae,\"__esModule\",{value:!0});var ie=n,ue=function(){function t(){}return t.prototype.exp=function(t){return this.expTable[t]},t.prototype.log=function(t){if(0===t)throw new ie.default;return this.logTable[t]},t.addOrSubtract=function(t,e){return t^e},t}();ae.default=ue,Object.defineProperty(oe,\"__esModule\",{value:!0});var fe=ae,le=C,se=n,de=function(){function t(t,e){if(0===e.length)throw new se.default;this.field=t;var r=e.length;if(r>1&&0===e[0]){for(var n=1;n<r&&0===e[n];)n++;n===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-n),le.default.arraycopy(e,n,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}return t.prototype.getCoefficients=function(){return this.coefficients},t.prototype.getDegree=function(){return this.coefficients.length-1},t.prototype.isZero=function(){return 0===this.coefficients[0]},t.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},t.prototype.evaluateAt=function(t){if(0===t)return this.getCoefficient(0);var e,r=this.coefficients;if(1===t){e=0;for(var n=0,o=r.length;n!==o;n++){var a=r[n];e=fe.default.addOrSubtract(e,a)}return e}e=r[0];var i=r.length,u=this.field;for(n=1;n<i;n++)e=fe.default.addOrSubtract(u.multiply(t,e),r[n]);return e},t.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new se.default(\"GenericGFPolys do not have same GenericGF field\");if(this.isZero())return e;if(e.isZero())return this;var r=this.coefficients,n=e.coefficients;if(r.length>n.length){var o=r;r=n,n=o}var a=new Int32Array(n.length),i=n.length-r.length;le.default.arraycopy(n,0,a,0,i);for(var u=i;u<n.length;u++)a[u]=fe.default.addOrSubtract(r[u-i],n[u]);return new t(this.field,a)},t.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new se.default(\"GenericGFPolys do not have same GenericGF field\");if(this.isZero()||e.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,o=e.coefficients,a=o.length,i=new Int32Array(n+a-1),u=this.field,f=0;f<n;f++)for(var l=r[f],s=0;s<a;s++)i[f+s]=fe.default.addOrSubtract(i[f+s],u.multiply(l,o[s]));return new t(u,i)},t.prototype.multiplyScalar=function(e){if(0===e)return this.field.getZero();if(1===e)return this;for(var r=this.coefficients.length,n=this.field,o=new Int32Array(r),a=this.coefficients,i=0;i<r;i++)o[i]=n.multiply(a[i],e);return new t(n,o)},t.prototype.multiplyByMonomial=function(e,r){if(e<0)throw new se.default;if(0===r)return this.field.getZero();for(var n=this.coefficients,o=n.length,a=new Int32Array(o+e),i=this.field,u=0;u<o;u++)a[u]=i.multiply(n[u],r);return new t(i,a)},t.prototype.divide=function(t){if(!this.field.equals(t.field))throw new se.default(\"GenericGFPolys do not have same GenericGF field\");if(t.isZero())throw new se.default(\"Divide by 0\");for(var e=this.field,r=e.getZero(),n=this,o=t.getCoefficient(t.getDegree()),a=e.inverse(o);n.getDegree()>=t.getDegree()&&!n.isZero();){var i=n.getDegree()-t.getDegree(),u=e.multiply(n.getCoefficient(n.getDegree()),a),f=t.multiplyByMonomial(i,u),l=e.buildMonomial(i,u);r=r.addOrSubtract(l),n=n.addOrSubtract(f)}return[r,n]},t.prototype.toString=function(){for(var t=\"\",e=this.getDegree();e>=0;e--){var r=this.getCoefficient(e);if(0!==r){if(r<0?(t+=\" - \",r=-r):t.length>0&&(t+=\" + \"),0===e||1!==r){var n=this.field.log(r);0===n?t+=\"1\":1===n?t+=\"a\":(t+=\"a^\",t+=n)}0!==e&&(1===e?t+=\"x\":(t+=\"x^\",t+=e))}}return t},t}();oe.default=de;var ce={},he=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ce,\"__esModule\",{value:!0});var pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return he(e,t),e.kind=\"ArithmeticException\",e}(o.default);ce.default=pe;var we=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ne,\"__esModule\",{value:!0});var ye=oe,_e=F,ge=n,ve=ce,Se=function(t){function e(e,r,n){var o=t.call(this)||this;o.primitive=e,o.size=r,o.generatorBase=n;for(var a=new Int32Array(r),i=1,u=0;u<r;u++)a[u]=i,(i*=2)>=r&&(i^=e,i&=r-1);o.expTable=a;var f=new Int32Array(r);for(u=0;u<r-1;u++)f[a[u]]=u;return o.logTable=f,o.zero=new ye.default(o,Int32Array.from([0])),o.one=new ye.default(o,Int32Array.from([1])),o}return we(e,t),e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,e){if(t<0)throw new ge.default;if(0===e)return this.zero;var r=new Int32Array(t+1);return r[0]=e,new ye.default(this,r)},e.prototype.inverse=function(t){if(0===t)throw new ve.default;return this.expTable[this.size-this.logTable[t]-1]},e.prototype.multiply=function(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return\"GF(0x\"+_e.default.toHexString(this.primitive)+\",\"+this.size+\")\"},e.prototype.equals=function(t){return t===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(ae.default);ne.default=Se;var Ae={},me={},Ie=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(me,\"__esModule\",{value:!0});var Oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ie(e,t),e.kind=\"ReedSolomonException\",e}(o.default);me.default=Oe;var Ce={},be=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ce,\"__esModule\",{value:!0});var Ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return be(e,t),e.kind=\"IllegalStateException\",e}(o.default);Ce.default=Ee,Object.defineProperty(Ae,\"__esModule\",{value:!0});var Me=ne,Ne=oe,Te=me,Pe=Ce,Be=function(){function t(t){this.field=t}return t.prototype.decode=function(t,e){for(var r=this.field,n=new Ne.default(r,t),o=new Int32Array(e),a=!0,i=0;i<e;i++){var u=n.evaluateAt(r.exp(i+r.getGeneratorBase()));o[o.length-1-i]=u,0!==u&&(a=!1)}if(!a){var f=new Ne.default(r,o),l=this.runEuclideanAlgorithm(r.buildMonomial(e,1),f,e),s=l[0],d=l[1],c=this.findErrorLocations(s),h=this.findErrorMagnitudes(d,c);for(i=0;i<c.length;i++){var p=t.length-1-r.log(c[i]);if(p<0)throw new Te.default(\"Bad error location\");t[p]=Me.default.addOrSubtract(t[p],h[i])}}},t.prototype.runEuclideanAlgorithm=function(t,e,r){if(t.getDegree()<e.getDegree()){var n=t;t=e,e=n}for(var o=this.field,a=t,i=e,u=o.getZero(),f=o.getOne();i.getDegree()>=(r/2|0);){var l=a,s=u;if(u=f,(a=i).isZero())throw new Te.default(\"r_{i-1} was zero\");i=l;for(var d=o.getZero(),c=a.getCoefficient(a.getDegree()),h=o.inverse(c);i.getDegree()>=a.getDegree()&&!i.isZero();){var p=i.getDegree()-a.getDegree(),w=o.multiply(i.getCoefficient(i.getDegree()),h);d=d.addOrSubtract(o.buildMonomial(p,w)),i=i.addOrSubtract(a.multiplyByMonomial(p,w))}if(f=d.multiply(u).addOrSubtract(s),i.getDegree()>=a.getDegree())throw new Pe.default(\"Division algorithm failed to reduce polynomial?\")}var y=f.getCoefficient(0);if(0===y)throw new Te.default(\"sigmaTilde(0) was zero\");var _=o.inverse(y);return[f.multiplyScalar(_),i.multiplyScalar(_)]},t.prototype.findErrorLocations=function(t){var e=t.getDegree();if(1===e)return Int32Array.from([t.getCoefficient(1)]);for(var r=new Int32Array(e),n=0,o=this.field,a=1;a<o.getSize()&&n<e;a++)0===t.evaluateAt(a)&&(r[n]=o.inverse(a),n++);if(n!==e)throw new Te.default(\"Error locator degree does not match number of roots\");return r},t.prototype.findErrorMagnitudes=function(t,e){for(var r=e.length,n=new Int32Array(r),o=this.field,a=0;a<r;a++){for(var i=o.inverse(e[a]),u=1,f=0;f<r;f++)if(a!==f){var l=o.multiply(e[f],i),s=0==(1&l)?1|l:-2&l;u=o.multiply(u,s)}n[a]=o.multiply(t.evaluateAt(i),o.inverse(u)),0!==o.getGeneratorBase()&&(n[a]=o.multiply(n[a],i))}return n},t}();Ae.default=Be;var Re={},De={},ke={},Ue={},xe={},Fe=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(xe,\"__esModule\",{value:!0});var Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe(e,t),e.kind=\"ArgumentException\",e}(o.default);xe.default=Le,function(t){Object.defineProperty(t,\"__esModule\",{value:!0}),t.ErrorCorrectionLevelValues=void 0;var e,r=xe,o=n;!function(t){t[t.L=0]=\"L\",t[t.M=1]=\"M\",t[t.Q=2]=\"Q\",t[t.H=3]=\"H\"}(e=t.ErrorCorrectionLevelValues||(t.ErrorCorrectionLevelValues={}));var a=function(){function t(e,r,n){this.value=e,this.stringValue=r,this.bits=n,t.FOR_BITS.set(n,this),t.FOR_VALUE.set(e,this)}return t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.fromString=function(e){switch(e){case\"L\":return t.L;case\"M\":return t.M;case\"Q\":return t.Q;case\"H\":return t.H;default:throw new r.default(e+\"not available\")}},t.prototype.toString=function(){return this.stringValue},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.forBits=function(e){if(e<0||e>=t.FOR_BITS.size)throw new o.default;return t.FOR_BITS.get(e)},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.L=new t(e.L,\"L\",1),t.M=new t(e.M,\"M\",0),t.Q=new t(e.Q,\"Q\",3),t.H=new t(e.H,\"H\",2),t}();t.default=a}(Ue);var je=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(ke,\"__esModule\",{value:!0});var ze=Ue,He=F,Ke=function(){function t(t){this.errorCorrectionLevel=ze.default.forBits(t>>3&3),this.dataMask=7&t}return t.numBitsDiffering=function(t,e){return He.default.bitCount(t^e)},t.decodeFormatInformation=function(e,r){var n=t.doDecodeFormatInformation(e,r);return null!==n?n:t.doDecodeFormatInformation(e^t.FORMAT_INFO_MASK_QR,r^t.FORMAT_INFO_MASK_QR)},t.doDecodeFormatInformation=function(e,r){var n,o,a=Number.MAX_SAFE_INTEGER,i=0;try{for(var u=je(t.FORMAT_INFO_DECODE_LOOKUP),f=u.next();!f.done;f=u.next()){var l=f.value,s=l[0];if(s===e||s===r)return new t(l[1]);var d=t.numBitsDiffering(e,s);d<a&&(i=l[1],a=d),e!==r&&(d=t.numBitsDiffering(r,s))<a&&(i=l[1],a=d)}}catch(t){n={error:t}}finally{try{f&&!f.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return a<=3?new t(i):null},t.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},t.prototype.getDataMask=function(){return this.dataMask},t.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},t.FORMAT_INFO_MASK_QR=21522,t.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],t}();ke.default=Ke;var Ve={},We=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(Ve,\"__esModule\",{value:!0});var Ze=function(){function t(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.ecCodewordsPerBlock=t,this.ecBlocks=e}return t.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},t.prototype.getNumBlocks=function(){var t,e,r=0,n=this.ecBlocks;try{for(var o=We(n),a=o.next();!a.done;a=o.next()){r+=a.value.getCount()}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},t.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},t.prototype.getECBlocks=function(){return this.ecBlocks},t}();Ve.default=Ze;var Ge={};Object.defineProperty(Ge,\"__esModule\",{value:!0});var Xe=function(){function t(t,e){this.count=t,this.dataCodewords=e}return t.prototype.getCount=function(){return this.count},t.prototype.getDataCodewords=function(){return this.dataCodewords},t}();Ge.default=Xe;var Ye=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(De,\"__esModule\",{value:!0});var qe=Z,Qe=ke,Je=Ve,$e=Ge,tr=Q,er=n,rr=function(){function t(t,e){for(var r,n,o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=o;var i=0,u=o[0].getECCodewordsPerBlock(),f=o[0].getECBlocks();try{for(var l=Ye(f),s=l.next();!s.done;s=l.next()){var d=s.value;i+=d.getCount()*(d.getDataCodewords()+u)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}this.totalCodewords=i}return t.prototype.getVersionNumber=function(){return this.versionNumber},t.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},t.prototype.getTotalCodewords=function(){return this.totalCodewords},t.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},t.prototype.getECBlocksForLevel=function(t){return this.ecBlocks[t.getValue()]},t.getProvisionalVersionForDimension=function(t){if(t%4!=1)throw new tr.default;try{return this.getVersionForNumber((t-17)/4)}catch(t){throw new tr.default}},t.getVersionForNumber=function(e){if(e<1||e>40)throw new er.default;return t.VERSIONS[e-1]},t.decodeVersionInformation=function(e){for(var r=Number.MAX_SAFE_INTEGER,n=0,o=0;o<t.VERSION_DECODE_INFO.length;o++){var a=t.VERSION_DECODE_INFO[o];if(a===e)return t.getVersionForNumber(o+7);var i=Qe.default.numBitsDiffering(e,a);i<r&&(n=o+7,r=i)}return r<=3?t.getVersionForNumber(n):null},t.prototype.buildFunctionPattern=function(){var t=this.getDimensionForVersion(),e=new qe.default(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);for(var r=this.alignmentPatternCenters.length,n=0;n<r;n++)for(var o=this.alignmentPatternCenters[n]-2,a=0;a<r;a++)0===n&&(0===a||a===r-1)||n===r-1&&0===a||e.setRegion(this.alignmentPatternCenters[a]-2,o,5,5);return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e},t.prototype.toString=function(){return\"\"+this.versionNumber},t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),t.VERSIONS=[new t(1,new Int32Array(0),new Je.default(7,new $e.default(1,19)),new Je.default(10,new $e.default(1,16)),new Je.default(13,new $e.default(1,13)),new Je.default(17,new $e.default(1,9))),new t(2,Int32Array.from([6,18]),new Je.default(10,new $e.default(1,34)),new Je.default(16,new $e.default(1,28)),new Je.default(22,new $e.default(1,22)),new Je.default(28,new $e.default(1,16))),new t(3,Int32Array.from([6,22]),new Je.default(15,new $e.default(1,55)),new Je.default(26,new $e.default(1,44)),new Je.default(18,new $e.default(2,17)),new Je.default(22,new $e.default(2,13))),new t(4,Int32Array.from([6,26]),new Je.default(20,new $e.default(1,80)),new Je.default(18,new $e.default(2,32)),new Je.default(26,new $e.default(2,24)),new Je.default(16,new $e.default(4,9))),new t(5,Int32Array.from([6,30]),new Je.default(26,new $e.default(1,108)),new Je.default(24,new $e.default(2,43)),new Je.default(18,new $e.default(2,15),new $e.default(2,16)),new Je.default(22,new $e.default(2,11),new $e.default(2,12))),new t(6,Int32Array.from([6,34]),new Je.default(18,new $e.default(2,68)),new Je.default(16,new $e.default(4,27)),new Je.default(24,new $e.default(4,19)),new Je.default(28,new $e.default(4,15))),new t(7,Int32Array.from([6,22,38]),new Je.default(20,new $e.default(2,78)),new Je.default(18,new $e.default(4,31)),new Je.default(18,new $e.default(2,14),new $e.default(4,15)),new Je.default(26,new $e.default(4,13),new $e.default(1,14))),new t(8,Int32Array.from([6,24,42]),new Je.default(24,new $e.default(2,97)),new Je.default(22,new $e.default(2,38),new $e.default(2,39)),new Je.default(22,new $e.default(4,18),new $e.default(2,19)),new Je.default(26,new $e.default(4,14),new $e.default(2,15))),new t(9,Int32Array.from([6,26,46]),new Je.default(30,new $e.default(2,116)),new Je.default(22,new $e.default(3,36),new $e.default(2,37)),new Je.default(20,new $e.default(4,16),new $e.default(4,17)),new Je.default(24,new $e.default(4,12),new $e.default(4,13))),new t(10,Int32Array.from([6,28,50]),new Je.default(18,new $e.default(2,68),new $e.default(2,69)),new Je.default(26,new $e.default(4,43),new $e.default(1,44)),new Je.default(24,new $e.default(6,19),new $e.default(2,20)),new Je.default(28,new $e.default(6,15),new $e.default(2,16))),new t(11,Int32Array.from([6,30,54]),new Je.default(20,new $e.default(4,81)),new Je.default(30,new $e.default(1,50),new $e.default(4,51)),new Je.default(28,new $e.default(4,22),new $e.default(4,23)),new Je.default(24,new $e.default(3,12),new $e.default(8,13))),new t(12,Int32Array.from([6,32,58]),new Je.default(24,new $e.default(2,92),new $e.default(2,93)),new Je.default(22,new $e.default(6,36),new $e.default(2,37)),new Je.default(26,new $e.default(4,20),new $e.default(6,21)),new Je.default(28,new $e.default(7,14),new $e.default(4,15))),new t(13,Int32Array.from([6,34,62]),new Je.default(26,new $e.default(4,107)),new Je.default(22,new $e.default(8,37),new $e.default(1,38)),new Je.default(24,new $e.default(8,20),new $e.default(4,21)),new Je.default(22,new $e.default(12,11),new $e.default(4,12))),new t(14,Int32Array.from([6,26,46,66]),new Je.default(30,new $e.default(3,115),new $e.default(1,116)),new Je.default(24,new $e.default(4,40),new $e.default(5,41)),new Je.default(20,new $e.default(11,16),new $e.default(5,17)),new Je.default(24,new $e.default(11,12),new $e.default(5,13))),new t(15,Int32Array.from([6,26,48,70]),new Je.default(22,new $e.default(5,87),new $e.default(1,88)),new Je.default(24,new $e.default(5,41),new $e.default(5,42)),new Je.default(30,new $e.default(5,24),new $e.default(7,25)),new Je.default(24,new $e.default(11,12),new $e.default(7,13))),new t(16,Int32Array.from([6,26,50,74]),new Je.default(24,new $e.default(5,98),new $e.default(1,99)),new Je.default(28,new $e.default(7,45),new $e.default(3,46)),new Je.default(24,new $e.default(15,19),new $e.default(2,20)),new Je.default(30,new $e.default(3,15),new $e.default(13,16))),new t(17,Int32Array.from([6,30,54,78]),new Je.default(28,new $e.default(1,107),new $e.default(5,108)),new Je.default(28,new $e.default(10,46),new $e.default(1,47)),new Je.default(28,new $e.default(1,22),new $e.default(15,23)),new Je.default(28,new $e.default(2,14),new $e.default(17,15))),new t(18,Int32Array.from([6,30,56,82]),new Je.default(30,new $e.default(5,120),new $e.default(1,121)),new Je.default(26,new $e.default(9,43),new $e.default(4,44)),new Je.default(28,new $e.default(17,22),new $e.default(1,23)),new Je.default(28,new $e.default(2,14),new $e.default(19,15))),new t(19,Int32Array.from([6,30,58,86]),new Je.default(28,new $e.default(3,113),new $e.default(4,114)),new Je.default(26,new $e.default(3,44),new $e.default(11,45)),new Je.default(26,new $e.default(17,21),new $e.default(4,22)),new Je.default(26,new $e.default(9,13),new $e.default(16,14))),new t(20,Int32Array.from([6,34,62,90]),new Je.default(28,new $e.default(3,107),new $e.default(5,108)),new Je.default(26,new $e.default(3,41),new $e.default(13,42)),new Je.default(30,new $e.default(15,24),new $e.default(5,25)),new Je.default(28,new $e.default(15,15),new $e.default(10,16))),new t(21,Int32Array.from([6,28,50,72,94]),new Je.default(28,new $e.default(4,116),new $e.default(4,117)),new Je.default(26,new $e.default(17,42)),new Je.default(28,new $e.default(17,22),new $e.default(6,23)),new Je.default(30,new $e.default(19,16),new $e.default(6,17))),new t(22,Int32Array.from([6,26,50,74,98]),new Je.default(28,new $e.default(2,111),new $e.default(7,112)),new Je.default(28,new $e.default(17,46)),new Je.default(30,new $e.default(7,24),new $e.default(16,25)),new Je.default(24,new $e.default(34,13))),new t(23,Int32Array.from([6,30,54,78,102]),new Je.default(30,new $e.default(4,121),new $e.default(5,122)),new Je.default(28,new $e.default(4,47),new $e.default(14,48)),new Je.default(30,new $e.default(11,24),new $e.default(14,25)),new Je.default(30,new $e.default(16,15),new $e.default(14,16))),new t(24,Int32Array.from([6,28,54,80,106]),new Je.default(30,new $e.default(6,117),new $e.default(4,118)),new Je.default(28,new $e.default(6,45),new $e.default(14,46)),new Je.default(30,new $e.default(11,24),new $e.default(16,25)),new Je.default(30,new $e.default(30,16),new $e.default(2,17))),new t(25,Int32Array.from([6,32,58,84,110]),new Je.default(26,new $e.default(8,106),new $e.default(4,107)),new Je.default(28,new $e.default(8,47),new $e.default(13,48)),new Je.default(30,new $e.default(7,24),new $e.default(22,25)),new Je.default(30,new $e.default(22,15),new $e.default(13,16))),new t(26,Int32Array.from([6,30,58,86,114]),new Je.default(28,new $e.default(10,114),new $e.default(2,115)),new Je.default(28,new $e.default(19,46),new $e.default(4,47)),new Je.default(28,new $e.default(28,22),new $e.default(6,23)),new Je.default(30,new $e.default(33,16),new $e.default(4,17))),new t(27,Int32Array.from([6,34,62,90,118]),new Je.default(30,new $e.default(8,122),new $e.default(4,123)),new Je.default(28,new $e.default(22,45),new $e.default(3,46)),new Je.default(30,new $e.default(8,23),new $e.default(26,24)),new Je.default(30,new $e.default(12,15),new $e.default(28,16))),new t(28,Int32Array.from([6,26,50,74,98,122]),new Je.default(30,new $e.default(3,117),new $e.default(10,118)),new Je.default(28,new $e.default(3,45),new $e.default(23,46)),new Je.default(30,new $e.default(4,24),new $e.default(31,25)),new Je.default(30,new $e.default(11,15),new $e.default(31,16))),new t(29,Int32Array.from([6,30,54,78,102,126]),new Je.default(30,new $e.default(7,116),new $e.default(7,117)),new Je.default(28,new $e.default(21,45),new $e.default(7,46)),new Je.default(30,new $e.default(1,23),new $e.default(37,24)),new Je.default(30,new $e.default(19,15),new $e.default(26,16))),new t(30,Int32Array.from([6,26,52,78,104,130]),new Je.default(30,new $e.default(5,115),new $e.default(10,116)),new Je.default(28,new $e.default(19,47),new $e.default(10,48)),new Je.default(30,new $e.default(15,24),new $e.default(25,25)),new Je.default(30,new $e.default(23,15),new $e.default(25,16))),new t(31,Int32Array.from([6,30,56,82,108,134]),new Je.default(30,new $e.default(13,115),new $e.default(3,116)),new Je.default(28,new $e.default(2,46),new $e.default(29,47)),new Je.default(30,new $e.default(42,24),new $e.default(1,25)),new Je.default(30,new $e.default(23,15),new $e.default(28,16))),new t(32,Int32Array.from([6,34,60,86,112,138]),new Je.default(30,new $e.default(17,115)),new Je.default(28,new $e.default(10,46),new $e.default(23,47)),new Je.default(30,new $e.default(10,24),new $e.default(35,25)),new Je.default(30,new $e.default(19,15),new $e.default(35,16))),new t(33,Int32Array.from([6,30,58,86,114,142]),new Je.default(30,new $e.default(17,115),new $e.default(1,116)),new Je.default(28,new $e.default(14,46),new $e.default(21,47)),new Je.default(30,new $e.default(29,24),new $e.default(19,25)),new Je.default(30,new $e.default(11,15),new $e.default(46,16))),new t(34,Int32Array.from([6,34,62,90,118,146]),new Je.default(30,new $e.default(13,115),new $e.default(6,116)),new Je.default(28,new $e.default(14,46),new $e.default(23,47)),new Je.default(30,new $e.default(44,24),new $e.default(7,25)),new Je.default(30,new $e.default(59,16),new $e.default(1,17))),new t(35,Int32Array.from([6,30,54,78,102,126,150]),new Je.default(30,new $e.default(12,121),new $e.default(7,122)),new Je.default(28,new $e.default(12,47),new $e.default(26,48)),new Je.default(30,new $e.default(39,24),new $e.default(14,25)),new Je.default(30,new $e.default(22,15),new $e.default(41,16))),new t(36,Int32Array.from([6,24,50,76,102,128,154]),new Je.default(30,new $e.default(6,121),new $e.default(14,122)),new Je.default(28,new $e.default(6,47),new $e.default(34,48)),new Je.default(30,new $e.default(46,24),new $e.default(10,25)),new Je.default(30,new $e.default(2,15),new $e.default(64,16))),new t(37,Int32Array.from([6,28,54,80,106,132,158]),new Je.default(30,new $e.default(17,122),new $e.default(4,123)),new Je.default(28,new $e.default(29,46),new $e.default(14,47)),new Je.default(30,new $e.default(49,24),new $e.default(10,25)),new Je.default(30,new $e.default(24,15),new $e.default(46,16))),new t(38,Int32Array.from([6,32,58,84,110,136,162]),new Je.default(30,new $e.default(4,122),new $e.default(18,123)),new Je.default(28,new $e.default(13,46),new $e.default(32,47)),new Je.default(30,new $e.default(48,24),new $e.default(14,25)),new Je.default(30,new $e.default(42,15),new $e.default(32,16))),new t(39,Int32Array.from([6,26,54,82,110,138,166]),new Je.default(30,new $e.default(20,117),new $e.default(4,118)),new Je.default(28,new $e.default(40,47),new $e.default(7,48)),new Je.default(30,new $e.default(43,24),new $e.default(22,25)),new Je.default(30,new $e.default(10,15),new $e.default(67,16))),new t(40,Int32Array.from([6,30,58,86,114,142,170]),new Je.default(30,new $e.default(19,118),new $e.default(6,119)),new Je.default(28,new $e.default(18,47),new $e.default(31,48)),new Je.default(30,new $e.default(34,24),new $e.default(34,25)),new Je.default(30,new $e.default(20,15),new $e.default(61,16)))],t}();De.default=rr;var nr={};!function(t){var e;Object.defineProperty(t,\"__esModule\",{value:!0}),t.DataMaskValues=void 0,function(t){t[t.DATA_MASK_000=0]=\"DATA_MASK_000\",t[t.DATA_MASK_001=1]=\"DATA_MASK_001\",t[t.DATA_MASK_010=2]=\"DATA_MASK_010\",t[t.DATA_MASK_011=3]=\"DATA_MASK_011\",t[t.DATA_MASK_100=4]=\"DATA_MASK_100\",t[t.DATA_MASK_101=5]=\"DATA_MASK_101\",t[t.DATA_MASK_110=6]=\"DATA_MASK_110\",t[t.DATA_MASK_111=7]=\"DATA_MASK_111\"}(e=t.DataMaskValues||(t.DataMaskValues={}));var r=function(){function t(t,e){this.value=t,this.isMasked=e}return t.prototype.unmaskBitMatrix=function(t,e){for(var r=0;r<e;r++)for(var n=0;n<e;n++)this.isMasked(r,n)&&t.flip(n,r)},t.values=new Map([[e.DATA_MASK_000,new t(e.DATA_MASK_000,(function(t,e){return 0==(t+e&1)}))],[e.DATA_MASK_001,new t(e.DATA_MASK_001,(function(t,e){return 0==(1&t)}))],[e.DATA_MASK_010,new t(e.DATA_MASK_010,(function(t,e){return e%3==0}))],[e.DATA_MASK_011,new t(e.DATA_MASK_011,(function(t,e){return(t+e)%3==0}))],[e.DATA_MASK_100,new t(e.DATA_MASK_100,(function(t,e){return 0==(Math.floor(t/2)+Math.floor(e/3)&1)}))],[e.DATA_MASK_101,new t(e.DATA_MASK_101,(function(t,e){return t*e%6==0}))],[e.DATA_MASK_110,new t(e.DATA_MASK_110,(function(t,e){return t*e%6<3}))],[e.DATA_MASK_111,new t(e.DATA_MASK_111,(function(t,e){return 0==(t+e+t*e%3&1)}))]]),t}();t.default=r}(nr),Object.defineProperty(Re,\"__esModule\",{value:!0});var or=De,ar=ke,ir=nr,ur=Q,fr=function(){function t(t){var e=t.getHeight();if(e<21||1!=(3&e))throw new ur.default;this.bitMatrix=t}return t.prototype.readFormatInformation=function(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;for(var t=0,e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var r=5;r>=0;r--)t=this.copyBit(8,r,t);var n=this.bitMatrix.getHeight(),o=0,a=n-7;for(r=n-1;r>=a;r--)o=this.copyBit(8,r,o);for(e=n-8;e<n;e++)o=this.copyBit(e,8,o);if(this.parsedFormatInfo=ar.default.decodeFormatInformation(t,o),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new ur.default},t.prototype.readVersion=function(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;var t=this.bitMatrix.getHeight(),e=Math.floor((t-17)/4);if(e<=6)return or.default.getVersionForNumber(e);for(var r=0,n=t-11,o=5;o>=0;o--)for(var a=t-9;a>=n;a--)r=this.copyBit(a,o,r);var i=or.default.decodeVersionInformation(r);if(null!==i&&i.getDimensionForVersion()===t)return this.parsedVersion=i,i;r=0;for(a=5;a>=0;a--)for(o=t-9;o>=n;o--)r=this.copyBit(a,o,r);if(null!==(i=or.default.decodeVersionInformation(r))&&i.getDimensionForVersion()===t)return this.parsedVersion=i,i;throw new ur.default},t.prototype.copyBit=function(t,e,r){return(this.isMirror?this.bitMatrix.get(e,t):this.bitMatrix.get(t,e))?r<<1|1:r<<1},t.prototype.readCodewords=function(){var t=this.readFormatInformation(),e=this.readVersion(),r=ir.default.values.get(t.getDataMask()),n=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,n);for(var o=e.buildFunctionPattern(),a=!0,i=new Uint8Array(e.getTotalCodewords()),u=0,f=0,l=0,s=n-1;s>0;s-=2){6===s&&s--;for(var d=0;d<n;d++)for(var c=a?n-1-d:d,h=0;h<2;h++)o.get(s-h,c)||(l++,f<<=1,this.bitMatrix.get(s-h,c)&&(f|=1),8===l&&(i[u++]=f,l=0,f=0));a=!a}if(u!==e.getTotalCodewords())throw new ur.default;return i},t.prototype.remask=function(){if(null!==this.parsedFormatInfo){var t=ir.default.values[this.parsedFormatInfo.getDataMask()],e=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,e)}},t.prototype.setMirror=function(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t},t.prototype.mirror=function(){for(var t=this.bitMatrix,e=0,r=t.getWidth();e<r;e++)for(var n=e+1,o=t.getHeight();n<o;n++)t.get(e,n)!==t.get(n,e)&&(t.flip(n,e),t.flip(e,n))},t}();Re.default=fr;var lr={},sr=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(lr,\"__esModule\",{value:!0});var dr=n,cr=function(){function t(t,e){this.numDataCodewords=t,this.codewords=e}return t.getDataBlocks=function(e,r,n){var o,a,i,u;if(e.length!==r.getTotalCodewords())throw new dr.default;var f=r.getECBlocksForLevel(n),l=0,s=f.getECBlocks();try{for(var d=sr(s),c=d.next();!c.done;c=d.next()){l+=(_=c.value).getCount()}}catch(t){o={error:t}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}var h=new Array(l),p=0;try{for(var w=sr(s),y=w.next();!y.done;y=w.next())for(var _=y.value,g=0;g<_.getCount();g++){var v=_.getDataCodewords(),S=f.getECCodewordsPerBlock()+v;h[p++]=new t(v,new Uint8Array(S))}}catch(t){i={error:t}}finally{try{y&&!y.done&&(u=w.return)&&u.call(w)}finally{if(i)throw i.error}}for(var A=h[0].codewords.length,m=h.length-1;m>=0;){if(h[m].codewords.length===A)break;m--}m++;var I=A-f.getECCodewordsPerBlock(),O=0;for(g=0;g<I;g++)for(var C=0;C<p;C++)h[C].codewords[g]=e[O++];for(C=m;C<p;C++)h[C].codewords[I]=e[O++];var b=h[0].codewords.length;for(g=I;g<b;g++)for(C=0;C<p;C++){var E=C<m?g:g+1;h[C].codewords[E]=e[O++]}return h},t.prototype.getNumDataCodewords=function(){return this.numDataCodewords},t.prototype.getCodewords=function(){return this.codewords},t}();lr.default=cr;var hr={},pr={};Object.defineProperty(pr,\"__esModule\",{value:!0});var wr=n,yr=function(){function t(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}return t.prototype.getBitOffset=function(){return this.bitOffset},t.prototype.getByteOffset=function(){return this.byteOffset},t.prototype.readBits=function(t){if(t<1||t>32||t>this.available())throw new wr.default(\"\"+t);var e=0,r=this.bitOffset,n=this.byteOffset,o=this.bytes;if(r>0){var a=8-r,i=t<a?t:a,u=255>>8-i<<(f=a-i);e=(o[n]&u)>>f,t-=i,8===(r+=i)&&(r=0,n++)}if(t>0){for(;t>=8;)e=e<<8|255&o[n],n++,t-=8;if(t>0){var f;u=255>>(f=8-t)<<f;e=e<<t|(o[n]&u)>>f,r+=t}}return this.bitOffset=r,this.byteOffset=n,e},t.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},t}();pr.default=yr;var _r={};Object.defineProperty(_r,\"__esModule\",{value:!0});var gr=function(){function t(t,e,r,n,o,a){void 0===o&&(o=-1),void 0===a&&(a=-1),this.rawBytes=t,this.text=e,this.byteSegments=r,this.ecLevel=n,this.structuredAppendSequenceNumber=o,this.structuredAppendParity=a,this.numBits=null==t?0:8*t.length}return t.prototype.getRawBytes=function(){return this.rawBytes},t.prototype.getNumBits=function(){return this.numBits},t.prototype.setNumBits=function(t){this.numBits=t},t.prototype.getText=function(){return this.text},t.prototype.getByteSegments=function(){return this.byteSegments},t.prototype.getECLevel=function(){return this.ecLevel},t.prototype.getErrorsCorrected=function(){return this.errorsCorrected},t.prototype.setErrorsCorrected=function(t){this.errorsCorrected=t},t.prototype.getErasures=function(){return this.erasures},t.prototype.setErasures=function(t){this.erasures=t},t.prototype.getOther=function(){return this.other},t.prototype.setOther=function(t){this.other=t},t.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},t.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},t.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},t}();_r.default=gr;var vr={};!function(t){Object.defineProperty(t,\"__esModule\",{value:!0}),t.ModeValues=void 0;var e,r=n;!function(t){t[t.TERMINATOR=0]=\"TERMINATOR\",t[t.NUMERIC=1]=\"NUMERIC\",t[t.ALPHANUMERIC=2]=\"ALPHANUMERIC\",t[t.STRUCTURED_APPEND=3]=\"STRUCTURED_APPEND\",t[t.BYTE=4]=\"BYTE\",t[t.ECI=5]=\"ECI\",t[t.KANJI=6]=\"KANJI\",t[t.FNC1_FIRST_POSITION=7]=\"FNC1_FIRST_POSITION\",t[t.FNC1_SECOND_POSITION=8]=\"FNC1_SECOND_POSITION\",t[t.HANZI=9]=\"HANZI\"}(e=t.ModeValues||(t.ModeValues={}));var o=function(){function t(e,r,n,o){this.value=e,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=o,t.FOR_BITS.set(o,this),t.FOR_VALUE.set(e,this)}return t.forBits=function(e){var n=t.FOR_BITS.get(e);if(void 0===n)throw new r.default;return n},t.prototype.getCharacterCountBits=function(t){var e,r=t.getVersionNumber();return e=r<=9?0:r<=26?1:2,this.characterCountBitsForVersions[e]},t.prototype.getValue=function(){return this.value},t.prototype.getBits=function(){return this.bits},t.prototype.equals=function(e){if(!(e instanceof t))return!1;var r=e;return this.value===r.value},t.prototype.toString=function(){return this.stringValue},t.FOR_BITS=new Map,t.FOR_VALUE=new Map,t.TERMINATOR=new t(e.TERMINATOR,\"TERMINATOR\",Int32Array.from([0,0,0]),0),t.NUMERIC=new t(e.NUMERIC,\"NUMERIC\",Int32Array.from([10,12,14]),1),t.ALPHANUMERIC=new t(e.ALPHANUMERIC,\"ALPHANUMERIC\",Int32Array.from([9,11,13]),2),t.STRUCTURED_APPEND=new t(e.STRUCTURED_APPEND,\"STRUCTURED_APPEND\",Int32Array.from([0,0,0]),3),t.BYTE=new t(e.BYTE,\"BYTE\",Int32Array.from([8,16,16]),4),t.ECI=new t(e.ECI,\"ECI\",Int32Array.from([0,0,0]),7),t.KANJI=new t(e.KANJI,\"KANJI\",Int32Array.from([8,10,12]),8),t.FNC1_FIRST_POSITION=new t(e.FNC1_FIRST_POSITION,\"FNC1_FIRST_POSITION\",Int32Array.from([0,0,0]),5),t.FNC1_SECOND_POSITION=new t(e.FNC1_SECOND_POSITION,\"FNC1_SECOND_POSITION\",Int32Array.from([0,0,0]),9),t.HANZI=new t(e.HANZI,\"HANZI\",Int32Array.from([8,10,12]),13),t}();t.default=o}(vr),Object.defineProperty(hr,\"__esModule\",{value:!0});var Sr=pr,Ar=q,mr=_r,Ir=X,Or=Q,Cr=G,br=tt,Er=vr,Mr=function(){function t(){}return t.decode=function(e,r,n,o){var a=new Sr.default(e),i=new Cr.default,u=new Array,f=-1,l=-1;try{var s=null,d=!1,c=void 0;do{if(a.available()<4)c=Er.default.TERMINATOR;else{var h=a.readBits(4);c=Er.default.forBits(h)}switch(c){case Er.default.TERMINATOR:break;case Er.default.FNC1_FIRST_POSITION:case Er.default.FNC1_SECOND_POSITION:d=!0;break;case Er.default.STRUCTURED_APPEND:if(a.available()<16)throw new Or.default;f=a.readBits(8),l=a.readBits(8);break;case Er.default.ECI:var p=t.parseECIValue(a);if(null===(s=Ar.default.getCharacterSetECIByValue(p)))throw new Or.default;break;case Er.default.HANZI:var w=a.readBits(4),y=a.readBits(c.getCharacterCountBits(r));w===t.GB2312_SUBSET&&t.decodeHanziSegment(a,i,y);break;default:var _=a.readBits(c.getCharacterCountBits(r));switch(c){case Er.default.NUMERIC:t.decodeNumericSegment(a,i,_);break;case Er.default.ALPHANUMERIC:t.decodeAlphanumericSegment(a,i,_,d);break;case Er.default.BYTE:t.decodeByteSegment(a,i,_,s,u,o);break;case Er.default.KANJI:t.decodeKanjiSegment(a,i,_);break;default:throw new Or.default}}}while(c!==Er.default.TERMINATOR)}catch(t){throw new Or.default}return new mr.default(e,i.toString(),0===u.length?null:u,null===n?null:n.toString(),f,l)},t.decodeHanziSegment=function(t,e,r){if(13*r>t.available())throw new Or.default;for(var n=new Uint8Array(2*r),o=0;r>0;){var a=t.readBits(13),i=a/96<<8&4294967295|a%96;i+=i<959?41377:42657,n[o]=i>>8&255,n[o+1]=255&i,o+=2,r--}try{e.append(br.default.decode(n,Ir.default.GB2312))}catch(t){throw new Or.default(t)}},t.decodeKanjiSegment=function(t,e,r){if(13*r>t.available())throw new Or.default;for(var n=new Uint8Array(2*r),o=0;r>0;){var a=t.readBits(13),i=a/192<<8&4294967295|a%192;i+=i<7936?33088:49472,n[o]=i>>8,n[o+1]=i,o+=2,r--}try{e.append(br.default.decode(n,Ir.default.SHIFT_JIS))}catch(t){throw new Or.default(t)}},t.decodeByteSegment=function(t,e,r,n,o,a){if(8*r>t.available())throw new Or.default;for(var i,u=new Uint8Array(r),f=0;f<r;f++)u[f]=t.readBits(8);i=null===n?Ir.default.guessEncoding(u,a):n.getName();try{e.append(br.default.decode(u,i))}catch(t){throw new Or.default(t)}o.push(u)},t.toAlphaNumericChar=function(e){if(e>=t.ALPHANUMERIC_CHARS.length)throw new Or.default;return t.ALPHANUMERIC_CHARS[e]},t.decodeAlphanumericSegment=function(e,r,n,o){for(var a=r.length();n>1;){if(e.available()<11)throw new Or.default;var i=e.readBits(11);r.append(t.toAlphaNumericChar(Math.floor(i/45))),r.append(t.toAlphaNumericChar(i%45)),n-=2}if(1===n){if(e.available()<6)throw new Or.default;r.append(t.toAlphaNumericChar(e.readBits(6)))}if(o)for(var u=a;u<r.length();u++)\"%\"===r.charAt(u)&&(u<r.length()-1&&\"%\"===r.charAt(u+1)?r.deleteCharAt(u+1):r.setCharAt(u,String.fromCharCode(29)))},t.decodeNumericSegment=function(e,r,n){for(;n>=3;){if(e.available()<10)throw new Or.default;var o=e.readBits(10);if(o>=1e3)throw new Or.default;r.append(t.toAlphaNumericChar(Math.floor(o/100))),r.append(t.toAlphaNumericChar(Math.floor(o/10)%10)),r.append(t.toAlphaNumericChar(o%10)),n-=3}if(2===n){if(e.available()<7)throw new Or.default;var a=e.readBits(7);if(a>=100)throw new Or.default;r.append(t.toAlphaNumericChar(Math.floor(a/10))),r.append(t.toAlphaNumericChar(a%10))}else if(1===n){if(e.available()<4)throw new Or.default;var i=e.readBits(4);if(i>=10)throw new Or.default;r.append(t.toAlphaNumericChar(i))}},t.parseECIValue=function(t){var e=t.readBits(8);if(0==(128&e))return 127&e;if(128==(192&e))return(63&e)<<8&4294967295|t.readBits(8);if(192==(224&e))return(31&e)<<16&4294967295|t.readBits(16);throw new Or.default},t.ALPHANUMERIC_CHARS=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:\",t.GB2312_SUBSET=1,t}();hr.default=Mr;var Nr={};Object.defineProperty(Nr,\"__esModule\",{value:!0});var Tr=function(){function t(t){this.mirrored=t}return t.prototype.isMirrored=function(){return this.mirrored},t.prototype.applyMirroredCorrection=function(t){if(this.mirrored&&null!==t&&!(t.length<3)){var e=t[0];t[0]=t[2],t[2]=e}},t}();Nr.default=Tr;var Pr=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty($t,\"__esModule\",{value:!0});var Br=te,Rr=Z,Dr=ne,kr=Ae,Ur=Re,xr=lr,Fr=hr,Lr=Nr,jr=function(){function t(){this.rsDecoder=new kr.default(Dr.default.QR_CODE_FIELD_256)}return t.prototype.decodeBooleanArray=function(t,e){return this.decodeBitMatrix(Rr.default.parseFromBooleanArray(t),e)},t.prototype.decodeBitMatrix=function(t,e){var r=new Ur.default(t),n=null;try{return this.decodeBitMatrixParser(r,e)}catch(t){n=t}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();var o=this.decodeBitMatrixParser(r,e);return o.setOther(new Lr.default(!0)),o}catch(t){if(null!==n)throw n;throw t}},t.prototype.decodeBitMatrixParser=function(t,e){var r,n,o,a,i=t.readVersion(),u=t.readFormatInformation().getErrorCorrectionLevel(),f=t.readCodewords(),l=xr.default.getDataBlocks(f,i,u),s=0;try{for(var d=Pr(l),c=d.next();!c.done;c=d.next()){s+=(_=c.value).getNumDataCodewords()}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}var h=new Uint8Array(s),p=0;try{for(var w=Pr(l),y=w.next();!y.done;y=w.next()){var _,g=(_=y.value).getCodewords(),v=_.getNumDataCodewords();this.correctErrors(g,v);for(var S=0;S<v;S++)h[p++]=g[S]}}catch(t){o={error:t}}finally{try{y&&!y.done&&(a=w.return)&&a.call(w)}finally{if(o)throw o.error}}return Fr.default.decode(h,i,u,e)},t.prototype.correctErrors=function(t,e){var r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch(t){throw new Br.default}for(var n=0;n<e;n++)t[n]=r[n]},t}();$t.default=jr;var zr={},Hr={};Object.defineProperty(Hr,\"__esModule\",{value:!0});var Kr=function(){function t(){}return t.round=function(t){return NaN===t?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0},t.distance=function(t,e,r,n){var o=t-r,a=e-n;return Math.sqrt(o*o+a*a)},t.sum=function(t){for(var e=0,r=0,n=t.length;r!==n;r++){e+=t[r]}return e},t}();Hr.default=Kr;var Vr={};Object.defineProperty(Vr,\"__esModule\",{value:!0});var Wr=function(){function t(t,e){this.bits=t,this.points=e}return t.prototype.getBits=function(){return this.bits},t.prototype.getPoints=function(){return this.points},t}();Vr.default=Wr;var Zr={},Gr={},Xr={};Object.defineProperty(Xr,\"__esModule\",{value:!0});var Yr=vt,qr=function(){function t(){}return t.checkAndNudgePoints=function(t,e){for(var r=t.getWidth(),n=t.getHeight(),o=!0,a=0;a<e.length&&o;a+=2){var i=Math.floor(e[a]),u=Math.floor(e[a+1]);if(i<-1||i>r||u<-1||u>n)throw new Yr.default;o=!1,-1===i?(e[a]=0,o=!0):i===r&&(e[a]=r-1,o=!0),-1===u?(e[a+1]=0,o=!0):u===n&&(e[a+1]=n-1,o=!0)}o=!0;for(a=e.length-2;a>=0&&o;a-=2){i=Math.floor(e[a]),u=Math.floor(e[a+1]);if(i<-1||i>r||u<-1||u>n)throw new Yr.default;o=!1,-1===i?(e[a]=0,o=!0):i===r&&(e[a]=r-1,o=!0),-1===u?(e[a+1]=0,o=!0):u===n&&(e[a+1]=n-1,o=!0)}},t}();Xr.default=qr;var Qr={};Object.defineProperty(Qr,\"__esModule\",{value:!0});var Jr=function(){function t(t,e,r,n,o,a,i,u,f){this.a11=t,this.a21=e,this.a31=r,this.a12=n,this.a22=o,this.a32=a,this.a13=i,this.a23=u,this.a33=f}return t.quadrilateralToQuadrilateral=function(e,r,n,o,a,i,u,f,l,s,d,c,h,p,w,y){var _=t.quadrilateralToSquare(e,r,n,o,a,i,u,f);return t.squareToQuadrilateral(l,s,d,c,h,p,w,y).times(_)},t.prototype.transformPoints=function(t){for(var e=t.length,r=this.a11,n=this.a12,o=this.a13,a=this.a21,i=this.a22,u=this.a23,f=this.a31,l=this.a32,s=this.a33,d=0;d<e;d+=2){var c=t[d],h=t[d+1],p=o*c+u*h+s;t[d]=(r*c+a*h+f)/p,t[d+1]=(n*c+i*h+l)/p}},t.prototype.transformPointsWithValues=function(t,e){for(var r=this.a11,n=this.a12,o=this.a13,a=this.a21,i=this.a22,u=this.a23,f=this.a31,l=this.a32,s=this.a33,d=t.length,c=0;c<d;c++){var h=t[c],p=e[c],w=o*h+u*p+s;t[c]=(r*h+a*p+f)/w,e[c]=(n*h+i*p+l)/w}},t.squareToQuadrilateral=function(e,r,n,o,a,i,u,f){var l=e-n+a-u,s=r-o+i-f;if(0===l&&0===s)return new t(n-e,a-n,e,o-r,i-o,r,0,0,1);var d=n-a,c=u-a,h=o-i,p=f-i,w=d*p-c*h,y=(l*p-c*s)/w,_=(d*s-l*h)/w;return new t(n-e+y*n,u-e+_*u,e,o-r+y*o,f-r+_*f,r,y,_,1)},t.quadrilateralToSquare=function(e,r,n,o,a,i,u,f){return t.squareToQuadrilateral(e,r,n,o,a,i,u,f).buildAdjoint()},t.prototype.buildAdjoint=function(){return new t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},t.prototype.times=function(e){return new t(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},t}();Qr.default=Jr;var $r=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Gr,\"__esModule\",{value:!0});var tn=Xr,en=Z,rn=Qr,nn=vt,on=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $r(e,t),e.prototype.sampleGrid=function(t,e,r,n,o,a,i,u,f,l,s,d,c,h,p,w,y,_,g){var v=rn.default.quadrilateralToQuadrilateral(n,o,a,i,u,f,l,s,d,c,h,p,w,y,_,g);return this.sampleGridWithTransform(t,e,r,v)},e.prototype.sampleGridWithTransform=function(t,e,r,n){if(e<=0||r<=0)throw new nn.default;for(var o=new en.default(e,r),a=new Float32Array(2*e),i=0;i<r;i++){for(var u=a.length,f=i+.5,l=0;l<u;l+=2)a[l]=l/2+.5,a[l+1]=f;n.transformPoints(a),tn.default.checkAndNudgePoints(t,a);try{for(l=0;l<u;l+=2)t.get(Math.floor(a[l]),Math.floor(a[l+1]))&&o.set(l/2,i)}catch(t){throw new nn.default}}return o},e}(tn.default);Gr.default=on,Object.defineProperty(Zr,\"__esModule\",{value:!0});var an=Gr,un=function(){function t(){}return t.setGridSampler=function(e){t.gridSampler=e},t.getInstance=function(){return t.gridSampler},t.gridSampler=new an.default,t}();Zr.default=un;var fn={},ln={};Object.defineProperty(ln,\"__esModule\",{value:!0});var sn=function(){function t(){}return t.floatToIntBits=function(t){return t},t.MAX_VALUE=Number.MAX_SAFE_INTEGER,t}();ln.default=sn,Object.defineProperty(fn,\"__esModule\",{value:!0});var dn=Hr,cn=ln,hn=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.equals=function(e){if(e instanceof t){var r=e;return this.x===r.x&&this.y===r.y}return!1},t.prototype.hashCode=function(){return 31*cn.default.floatToIntBits(this.x)+cn.default.floatToIntBits(this.y)},t.prototype.toString=function(){return\"(\"+this.x+\",\"+this.y+\")\"},t.orderBestPatterns=function(t){var e,r,n,o=this.distance(t[0],t[1]),a=this.distance(t[1],t[2]),i=this.distance(t[0],t[2]);if(a>=o&&a>=i?(r=t[0],e=t[1],n=t[2]):i>=a&&i>=o?(r=t[1],e=t[0],n=t[2]):(r=t[2],e=t[0],n=t[1]),this.crossProductZ(e,r,n)<0){var u=e;e=n,n=u}t[0]=e,t[1]=r,t[2]=n},t.distance=function(t,e){return dn.default.distance(t.x,t.y,e.x,e.y)},t.crossProductZ=function(t,e,r){var n=e.x,o=e.y;return(r.x-n)*(t.y-o)-(r.y-o)*(t.x-n)},t}();fn.default=hn;var pn={},wn={},yn=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(wn,\"__esModule\",{value:!0});var _n=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o.estimatedModuleSize=n,o}return yn(e,t),e.prototype.aboutEquals=function(t,e,r){if(Math.abs(e-this.getY())<=t&&Math.abs(r-this.getX())<=t){var n=Math.abs(t-this.estimatedModuleSize);return n<=1||n<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,r,n){return new e((this.getX()+r)/2,(this.getY()+t)/2,(this.estimatedModuleSize+n)/2)},e}(fn.default);wn.default=_n;var gn=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(pn,\"__esModule\",{value:!0});var vn=wn,Sn=vt,An=function(){function t(t,e,r,n,o,a,i){this.image=t,this.startX=e,this.startY=r,this.width=n,this.height=o,this.moduleSize=a,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return t.prototype.find=function(){for(var t=this.startX,e=this.height,r=t+this.width,n=this.startY+e/2,o=new Int32Array(3),a=this.image,i=0;i<e;i++){var u=n+(0==(1&i)?Math.floor((i+1)/2):-Math.floor((i+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var f=t;f<r&&!a.get(f,u);)f++;for(var l=0;f<r;){if(a.get(f,u))if(1===l)o[1]++;else if(2===l){var s;if(this.foundPatternCross(o))if(null!==(s=this.handlePossibleCenter(o,u,f)))return s;o[0]=o[2],o[1]=1,o[2]=0,l=1}else o[++l]++;else 1===l&&l++,o[l]++;f++}if(this.foundPatternCross(o))if(null!==(s=this.handlePossibleCenter(o,u,r)))return s}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new Sn.default},t.centerFromEnd=function(t,e){return e-t[2]-t[1]/2},t.prototype.foundPatternCross=function(t){for(var e=this.moduleSize,r=e/2,n=0;n<3;n++)if(Math.abs(e-t[n])>=r)return!1;return!0},t.prototype.crossCheckVertical=function(e,r,n,o){var a=this.image,i=a.getHeight(),u=this.crossCheckStateCount;u[0]=0,u[1]=0,u[2]=0;for(var f=e;f>=0&&a.get(r,f)&&u[1]<=n;)u[1]++,f--;if(f<0||u[1]>n)return NaN;for(;f>=0&&!a.get(r,f)&&u[0]<=n;)u[0]++,f--;if(u[0]>n)return NaN;for(f=e+1;f<i&&a.get(r,f)&&u[1]<=n;)u[1]++,f++;if(f===i||u[1]>n)return NaN;for(;f<i&&!a.get(r,f)&&u[2]<=n;)u[2]++,f++;if(u[2]>n)return NaN;var l=u[0]+u[1]+u[2];return 5*Math.abs(l-o)>=2*o?NaN:this.foundPatternCross(u)?t.centerFromEnd(u,f):NaN},t.prototype.handlePossibleCenter=function(e,r,n){var o,a,i=e[0]+e[1]+e[2],u=t.centerFromEnd(e,n),f=this.crossCheckVertical(r,u,2*e[1],i);if(!isNaN(f)){var l=(e[0]+e[1]+e[2])/3;try{for(var s=gn(this.possibleCenters),d=s.next();!d.done;d=s.next()){var c=d.value;if(c.aboutEquals(l,f,u))return c.combineEstimate(f,u,l)}}catch(t){o={error:t}}finally{try{d&&!d.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}var h=new vn.default(u,f,l);this.possibleCenters.push(h),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(h)}return null},t}();pn.default=An;var mn={},In={},On=t&&t.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(In,\"__esModule\",{value:!0});var Cn=function(t){function e(e,r,n,o){var a=t.call(this,e,r)||this;return a.estimatedModuleSize=n,a.count=o,void 0===o&&(a.count=1),a}return On(e,t),e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(t,e,r){if(Math.abs(e-this.getY())<=t&&Math.abs(r-this.getX())<=t){var n=Math.abs(t-this.estimatedModuleSize);return n<=1||n<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,r,n){var o=this.count+1;return new e((this.count*this.getX()+r)/o,(this.count*this.getY()+t)/o,(this.count*this.estimatedModuleSize+n)/o,o)},e}(fn.default);In.default=Cn;var bn={};Object.defineProperty(bn,\"__esModule\",{value:!0});var En=function(){function t(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}return t.prototype.getBottomLeft=function(){return this.bottomLeft},t.prototype.getTopLeft=function(){return this.topLeft},t.prototype.getTopRight=function(){return this.topRight},t}();bn.default=En;var Mn=t&&t.__values||function(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")};Object.defineProperty(mn,\"__esModule\",{value:!0});var Nn=Y,Tn=fn,Pn=In,Bn=bn,Rn=vt,Dn=function(){function t(t,e){this.image=t,this.resultPointCallback=e,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=e}return t.prototype.getImage=function(){return this.image},t.prototype.getPossibleCenters=function(){return this.possibleCenters},t.prototype.find=function(e){var r=null!=e&&void 0!==e.get(Nn.default.TRY_HARDER),n=null!=e&&void 0!==e.get(Nn.default.PURE_BARCODE),o=this.image,a=o.getHeight(),i=o.getWidth(),u=Math.floor(3*a/(4*t.MAX_MODULES));(u<t.MIN_SKIP||r)&&(u=t.MIN_SKIP);for(var f=!1,l=new Int32Array(5),s=u-1;s<a&&!f;s+=u){l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0;for(var d=0,c=0;c<i;c++)if(o.get(c,s))1==(1&d)&&d++,l[d]++;else if(0==(1&d))if(4===d)if(t.foundPatternCross(l)){if(!0!==this.handlePossibleCenter(l,s,c,n)){l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,d=3;continue}if(u=2,!0===this.hasSkipped)f=this.haveMultiplyConfirmedCenters();else{var h=this.findRowSkip();h>l[2]&&(s+=h-l[2]-u,c=i-1)}d=0,l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0}else l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,d=3;else l[++d]++;else l[d]++;if(t.foundPatternCross(l))!0===this.handlePossibleCenter(l,s,i,n)&&(u=l[0],this.hasSkipped&&(f=this.haveMultiplyConfirmedCenters()))}var p=this.selectBestPatterns();return Tn.default.orderBestPatterns(p),new Bn.default(p)},t.centerFromEnd=function(t,e){return e-t[4]-t[3]-t[2]/2},t.foundPatternCross=function(t){for(var e=0,r=0;r<5;r++){var n=t[r];if(0===n)return!1;e+=n}if(e<7)return!1;var o=e/7,a=o/2;return Math.abs(o-t[0])<a&&Math.abs(o-t[1])<a&&Math.abs(3*o-t[2])<3*a&&Math.abs(o-t[3])<a&&Math.abs(o-t[4])<a},t.prototype.getCrossCheckStateCount=function(){var t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t},t.prototype.crossCheckDiagonal=function(e,r,n,o){for(var a=this.getCrossCheckStateCount(),i=0,u=this.image;e>=i&&r>=i&&u.get(r-i,e-i);)a[2]++,i++;if(e<i||r<i)return!1;for(;e>=i&&r>=i&&!u.get(r-i,e-i)&&a[1]<=n;)a[1]++,i++;if(e<i||r<i||a[1]>n)return!1;for(;e>=i&&r>=i&&u.get(r-i,e-i)&&a[0]<=n;)a[0]++,i++;if(a[0]>n)return!1;var f=u.getHeight(),l=u.getWidth();for(i=1;e+i<f&&r+i<l&&u.get(r+i,e+i);)a[2]++,i++;if(e+i>=f||r+i>=l)return!1;for(;e+i<f&&r+i<l&&!u.get(r+i,e+i)&&a[3]<n;)a[3]++,i++;if(e+i>=f||r+i>=l||a[3]>=n)return!1;for(;e+i<f&&r+i<l&&u.get(r+i,e+i)&&a[4]<n;)a[4]++,i++;if(a[4]>=n)return!1;var s=a[0]+a[1]+a[2]+a[3]+a[4];return Math.abs(s-o)<2*o&&t.foundPatternCross(a)},t.prototype.crossCheckVertical=function(e,r,n,o){for(var a=this.image,i=a.getHeight(),u=this.getCrossCheckStateCount(),f=e;f>=0&&a.get(r,f);)u[2]++,f--;if(f<0)return NaN;for(;f>=0&&!a.get(r,f)&&u[1]<=n;)u[1]++,f--;if(f<0||u[1]>n)return NaN;for(;f>=0&&a.get(r,f)&&u[0]<=n;)u[0]++,f--;if(u[0]>n)return NaN;for(f=e+1;f<i&&a.get(r,f);)u[2]++,f++;if(f===i)return NaN;for(;f<i&&!a.get(r,f)&&u[3]<n;)u[3]++,f++;if(f===i||u[3]>=n)return NaN;for(;f<i&&a.get(r,f)&&u[4]<n;)u[4]++,f++;if(u[4]>=n)return NaN;var l=u[0]+u[1]+u[2]+u[3]+u[4];return 5*Math.abs(l-o)>=2*o?NaN:t.foundPatternCross(u)?t.centerFromEnd(u,f):NaN},t.prototype.crossCheckHorizontal=function(e,r,n,o){for(var a=this.image,i=a.getWidth(),u=this.getCrossCheckStateCount(),f=e;f>=0&&a.get(f,r);)u[2]++,f--;if(f<0)return NaN;for(;f>=0&&!a.get(f,r)&&u[1]<=n;)u[1]++,f--;if(f<0||u[1]>n)return NaN;for(;f>=0&&a.get(f,r)&&u[0]<=n;)u[0]++,f--;if(u[0]>n)return NaN;for(f=e+1;f<i&&a.get(f,r);)u[2]++,f++;if(f===i)return NaN;for(;f<i&&!a.get(f,r)&&u[3]<n;)u[3]++,f++;if(f===i||u[3]>=n)return NaN;for(;f<i&&a.get(f,r)&&u[4]<n;)u[4]++,f++;if(u[4]>=n)return NaN;var l=u[0]+u[1]+u[2]+u[3]+u[4];return 5*Math.abs(l-o)>=o?NaN:t.foundPatternCross(u)?t.centerFromEnd(u,f):NaN},t.prototype.handlePossibleCenter=function(e,r,n,o){var a=e[0]+e[1]+e[2]+e[3]+e[4],i=t.centerFromEnd(e,n),u=this.crossCheckVertical(r,Math.floor(i),e[2],a);if(!isNaN(u)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(u),e[2],a),!isNaN(i)&&(!o||this.crossCheckDiagonal(Math.floor(u),Math.floor(i),e[2],a)))){for(var f=a/7,l=!1,s=this.possibleCenters,d=0,c=s.length;d<c;d++){var h=s[d];if(h.aboutEquals(f,u,i)){s[d]=h.combineEstimate(u,i,f),l=!0;break}}if(!l){var p=new Pn.default(i,u,f);s.push(p),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(p)}return!0}return!1},t.prototype.findRowSkip=function(){var e,r;if(this.possibleCenters.length<=1)return 0;var n=null;try{for(var o=Mn(this.possibleCenters),a=o.next();!a.done;a=o.next()){var i=a.value;if(i.getCount()>=t.CENTER_QUORUM){if(null!=n)return this.hasSkipped=!0,Math.floor((Math.abs(n.getX()-i.getX())-Math.abs(n.getY()-i.getY()))/2);n=i}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return 0},t.prototype.haveMultiplyConfirmedCenters=function(){var e,r,n,o,a=0,i=0,u=this.possibleCenters.length;try{for(var f=Mn(this.possibleCenters),l=f.next();!l.done;l=f.next()){(p=l.value).getCount()>=t.CENTER_QUORUM&&(a++,i+=p.getEstimatedModuleSize())}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}if(a<3)return!1;var s=i/u,d=0;try{for(var c=Mn(this.possibleCenters),h=c.next();!h.done;h=c.next()){var p=h.value;d+=Math.abs(p.getEstimatedModuleSize()-s)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return d<=.05*i},t.prototype.selectBestPatterns=function(){var t,e,r,n,o=this.possibleCenters.length;if(o<3)throw new Rn.default;var a,i=this.possibleCenters;if(o>3){var u=0,f=0;try{for(var l=Mn(this.possibleCenters),s=l.next();!s.done;s=l.next()){var d=s.value.getEstimatedModuleSize();u+=d,f+=d*d}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}a=u/o;var c=Math.sqrt(f/o-a*a);i.sort((function(t,e){var r=Math.abs(e.getEstimatedModuleSize()-a),n=Math.abs(t.getEstimatedModuleSize()-a);return r<n?-1:r>n?1:0}));for(var h=Math.max(.2*a,c),p=0;p<i.length&&i.length>3;p++){var w=i[p];Math.abs(w.getEstimatedModuleSize()-a)>h&&(i.splice(p,1),p--)}}if(i.length>3){u=0;try{for(var y=Mn(i),_=y.next();!_.done;_=y.next()){u+=_.value.getEstimatedModuleSize()}}catch(t){r={error:t}}finally{try{_&&!_.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}a=u/i.length,i.sort((function(t,e){if(e.getCount()===t.getCount()){var r=Math.abs(e.getEstimatedModuleSize()-a),n=Math.abs(t.getEstimatedModuleSize()-a);return r<n?1:r>n?-1:0}return e.getCount()-t.getCount()})),i.splice(3)}return[i[0],i[1],i[2]]},t.CENTER_QUORUM=2,t.MIN_SKIP=3,t.MAX_MODULES=57,t}();mn.default=Dn,Object.defineProperty(zr,\"__esModule\",{value:!0});var kn=Hr,Un=Vr,xn=Zr,Fn=Qr,Ln=Y,jn=vt,zn=fn,Hn=De,Kn=pn,Vn=mn,Wn=function(){function t(t){this.image=t}return t.prototype.getImage=function(){return this.image},t.prototype.getResultPointCallback=function(){return this.resultPointCallback},t.prototype.detect=function(t){this.resultPointCallback=null==t?null:t.get(Ln.default.NEED_RESULT_POINT_CALLBACK);var e=new Vn.default(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(e)},t.prototype.processFinderPatternInfo=function(e){var r=e.getTopLeft(),n=e.getTopRight(),o=e.getBottomLeft(),a=this.calculateModuleSize(r,n,o);if(a<1)throw new jn.default(\"No pattern found in proccess finder.\");var i=t.computeDimension(r,n,o,a),u=Hn.default.getProvisionalVersionForDimension(i),f=u.getDimensionForVersion()-7,l=null;if(u.getAlignmentPatternCenters().length>0)for(var s=n.getX()-r.getX()+o.getX(),d=n.getY()-r.getY()+o.getY(),c=1-3/f,h=Math.floor(r.getX()+c*(s-r.getX())),p=Math.floor(r.getY()+c*(d-r.getY())),w=4;w<=16;w<<=1)try{l=this.findAlignmentInRegion(a,h,p,w);break}catch(t){if(!(t instanceof jn.default))throw t}var y,_=t.createTransform(r,n,o,l,i),g=t.sampleGrid(this.image,_,i);return y=null===l?[o,r,n]:[o,r,n,l],new Un.default(g,y)},t.createTransform=function(t,e,r,n,o){var a,i,u,f,l=o-3.5;return null!==n?(a=n.getX(),i=n.getY(),f=u=l-3):(a=e.getX()-t.getX()+r.getX(),i=e.getY()-t.getY()+r.getY(),u=l,f=l),Fn.default.quadrilateralToQuadrilateral(3.5,3.5,l,3.5,u,f,3.5,l,t.getX(),t.getY(),e.getX(),e.getY(),a,i,r.getX(),r.getY())},t.sampleGrid=function(t,e,r){return xn.default.getInstance().sampleGridWithTransform(t,r,r,e)},t.computeDimension=function(t,e,r,n){var o=kn.default.round(zn.default.distance(t,e)/n),a=kn.default.round(zn.default.distance(t,r)/n),i=Math.floor((o+a)/2)+7;switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw new jn.default(\"Dimensions could be not found.\")}return i},t.prototype.calculateModuleSize=function(t,e,r){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,r))/2},t.prototype.calculateModuleSizeOneWay=function(t,e){var r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY())),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(r)?n/7:isNaN(n)?r/7:(r+n)/14},t.prototype.sizeOfBlackWhiteBlackRunBothWays=function(t,e,r,n){var o=this.sizeOfBlackWhiteBlackRun(t,e,r,n),a=1,i=t-(r-t);i<0?(a=t/(t-i),i=0):i>=this.image.getWidth()&&(a=(this.image.getWidth()-1-t)/(i-t),i=this.image.getWidth()-1);var u=Math.floor(e-(n-e)*a);return a=1,u<0?(a=e/(e-u),u=0):u>=this.image.getHeight()&&(a=(this.image.getHeight()-1-e)/(u-e),u=this.image.getHeight()-1),i=Math.floor(t+(i-t)*a),(o+=this.sizeOfBlackWhiteBlackRun(t,e,i,u))-1},t.prototype.sizeOfBlackWhiteBlackRun=function(t,e,r,n){var o=Math.abs(n-e)>Math.abs(r-t);if(o){var a=t;t=e,e=a,a=r,r=n,n=a}for(var i=Math.abs(r-t),u=Math.abs(n-e),f=-i/2,l=t<r?1:-1,s=e<n?1:-1,d=0,c=r+l,h=t,p=e;h!==c;h+=l){var w=o?p:h,y=o?h:p;if(1===d===this.image.get(w,y)){if(2===d)return kn.default.distance(h,p,t,e);d++}if((f+=u)>0){if(p===n)break;p+=s,f-=i}}return 2===d?kn.default.distance(r+l,n,t,e):NaN},t.prototype.findAlignmentInRegion=function(t,e,r,n){var o=Math.floor(n*t),a=Math.max(0,e-o),i=Math.min(this.image.getWidth()-1,e+o);if(i-a<3*t)throw new jn.default(\"Alignment top exceeds estimated module size.\");var u=Math.max(0,r-o),f=Math.min(this.image.getHeight()-1,r+o);if(f-u<3*t)throw new jn.default(\"Alignment bottom exceeds estimated module size.\");return new Kn.default(this.image,a,u,i-a,f-u,t,this.resultPointCallback).find()},t}();zr.default=Wn,Object.defineProperty(Zt,\"__esModule\",{value:!0});var Zn=Gt,Gn=Z,Xn=Y,Yn=vt,qn=Xt,Qn=Jt,Jn=$t,$n=Nr,to=zr,eo=function(){function t(){this.decoder=new Jn.default}return t.prototype.getDecoder=function(){return this.decoder},t.prototype.decode=function(e,r){var n,o;if(null!=r&&void 0!==r.get(Xn.default.PURE_BARCODE)){var a=t.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(a,r),o=t.NO_POINTS}else{var i=new to.default(e.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(i.getBits(),r),o=i.getPoints()}n.getOther()instanceof $n.default&&n.getOther().applyMirroredCorrection(o);var u=new qn.default(n.getText(),n.getRawBytes(),void 0,o,Zn.default.QR_CODE,void 0),f=n.getByteSegments();null!==f&&u.putMetadata(Qn.default.BYTE_SEGMENTS,f);var l=n.getECLevel();return null!==l&&u.putMetadata(Qn.default.ERROR_CORRECTION_LEVEL,l),n.hasStructuredAppend()&&(u.putMetadata(Qn.default.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),u.putMetadata(Qn.default.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),u},t.prototype.reset=function(){},t.extractPureBits=function(t){var e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(null===e||null===r)throw new Yn.default;var n=this.moduleSize(e,t),o=e[1],a=r[1],i=e[0],u=r[0];if(i>=u||o>=a)throw new Yn.default;if(a-o!=u-i&&(u=i+(a-o))>=t.getWidth())throw new Yn.default;var f=Math.round((u-i+1)/n),l=Math.round((a-o+1)/n);if(f<=0||l<=0)throw new Yn.default;if(l!==f)throw new Yn.default;var s=Math.floor(n/2);o+=s;var d=(i+=s)+Math.floor((f-1)*n)-u;if(d>0){if(d>s)throw new Yn.default;i-=d}var c=o+Math.floor((l-1)*n)-a;if(c>0){if(c>s)throw new Yn.default;o-=c}for(var h=new Gn.default(f,l),p=0;p<l;p++)for(var w=o+Math.floor(p*n),y=0;y<f;y++)t.get(i+Math.floor(y*n),w)&&h.set(y,p);return h},t.moduleSize=function(t,e){for(var r=e.getHeight(),n=e.getWidth(),o=t[0],a=t[1],i=!0,u=0;o<n&&a<r;){if(i!==e.get(o,a)){if(5==++u)break;i=!i}o++,a++}if(o===n||a===r)throw new Yn.default;return(o-t[0])/7},t.NO_POINTS=new Array,t}(),ro=Zt.default=eo,no=new ro;self.onmessage=function(t){try{var e=function(t,e,r){for(var n=new Uint8ClampedArray(e*r),o=0,a=0,i=t.length;o<i;o+=4,a++){var u=void 0;u=0===t[o+3]?255:306*t[o]+601*t[o+1]+117*t[o+2]+512>>10,n[a]=u}return n}(t.data.data,t.data.width,t.data.height),r=new Wt(e,t.data.width,t.data.height),n=new Tt(r),o=new g(n),a=no.decode(o);postMessage(a)}catch(t){postMessage(null)}}}();");

var _excluded = ["constraints", "onError", "onLoad", "onScan", "resolution"];

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

var createWorker = function createWorker() {
  return new WebWorker();
};

var stopMediaStream = function stopMediaStream(stream) {
  if (stream) {
    if (stream.getVideoTracks && stream.getAudioTracks) {
      stream.getVideoTracks().forEach(function (track) {
        stream.removeTrack(track);
        track.stop();
      });
      stream.getAudioTracks().forEach(function (track) {
        stream.removeTrack(track);
        track.stop();
      });
    } else {
      stream.stop();
    }
  }
};

var Reader = function Reader(props) {
  var constraints = props.constraints,
      onError = props.onError,
      onLoad = props.onLoad,
      onScan = props.onScan,
      resolution = props.resolution,
      other = objectWithoutProperties(props, _excluded);

  var constraintsStr = JSON.stringify(constraints);
  var streamRef = useRef(null);
  var videoEl = useRef(null);
  var canvasEl = useRef(document.createElement("canvas"));
  var ctxRef = useRef(null);
  var requestRef = useRef();

  var _useState = useState(null),
      _useState2 = slicedToArray(_useState, 2),
      src = _useState2[0],
      setSrc = _useState2[1];

  var isProcessingRef = useRef(false);
  var worker = useMemo(createWorker, [createWorker]);
  useEffect(function () {
    return function () {
      worker.terminate();
    };
  }, [worker]);
  useEffect(function () {
    worker.onerror = function (event) {
      console.log("error", event);
    };

    worker.onmessage = function (e) {
      if (onScan) onScan(e.data ? _objectSpread(_objectSpread({}, e.data), {}, {
        canvas: canvasEl.current
      }) : null);
      isProcessingRef.current = false;
    };
  }, [onScan, worker]);
  var check = useCallback(function () {
    var videoIsPlaying = videoEl.current && videoEl.current.readyState === videoEl.current.HAVE_ENOUGH_DATA;

    if (!isProcessingRef.current && videoIsPlaying) {
      isProcessingRef.current = true; // Get image/video dimensions

      var width = videoEl.current.videoWidth;
      var height = videoEl.current.videoHeight;
      var greatestSize = width > height ? width : height;
      var ratio = resolution / greatestSize;
      height = ratio * height;
      width = ratio * width;
      canvasEl.current.width = width;
      canvasEl.current.height = height;
      ctxRef.current = canvasEl.current.getContext("2d");
      ctxRef.current.drawImage(videoEl.current, 0, 0, width, height);
      var imageData = ctxRef.current.getImageData(0, 0, width, height); // Send data to web-worker

      worker.postMessage(imageData);
    }

    requestRef.current = requestAnimationFrame(check);
  }, [resolution, worker]);
  useEffect(function () {
    var constraints = JSON.parse(constraintsStr);
    var isSubscribed = true;
    navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {
      if (!isSubscribed) {
        stopMediaStream(stream);
      } else {
        streamRef.current = stream;

        try {
          if (videoEl.current) {
            videoEl.current.srcObject = stream;
            videoEl.current.setAttribute("playsinline", true); // required to tell iOS safari we don't want fullscreen
          }
        } catch (error) {
          setSrc(window.URL.createObjectURL(stream));
        }

        if (onLoad) onLoad();
        requestRef.current = requestAnimationFrame(check);
      }
    })["catch"](function (error) {
      return isSubscribed ? onError(error) : null;
    });
    return function () {
      cancelAnimationFrame(requestRef.current);
      isSubscribed = false;
      stopMediaStream(streamRef.current);

      if (src) {
        window.URL.revokeObjectURL(src);
      }
    };
  }, [check, constraintsStr, onError, onLoad, src]);
  return /*#__PURE__*/React.createElement("video", _extends$1({
    autoPlay: true,
    playsInline: true,
    src: src,
    ref: videoEl
  }, other));
};

Reader.propTypes = {
  constraints: PropTypes.object,
  onError: PropTypes.func.isRequired,
  onLoad: PropTypes.func,
  onScan: PropTypes.func.isRequired,
  resolution: PropTypes.number
};
Reader.defaultProps = {
  constraints: {
    audio: false,
    video: true
  },
  resolution: 640
};

export { Reader as default };
